---
title: "Include Query Timings"
hide_table_of_contents: true
sidebar_label: Include Query Timings
sidebar_position: 1
---

import Admonition from '@theme/Admonition';
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import CodeBlock from '@theme/CodeBlock';
import LanguageSwitcher from "@site/src/components/LanguageSwitcher";
import LanguageContent from "@site/src/components/LanguageContent";

export const supportedLanguages = ["csharp", "java", "python", "php", "nodejs"];


# Include Query Timings
<LanguageSwitcher supportedLanguages={supportedLanguages} />
<LanguageContent language="csharp">

<Admonition type="note" title="">

* When making a query,   
  you can request to get detailed stats of the time spent by RavenDB on each part of the query.  
  E.g. duration of search, loading documents, transforming results, total duration, etc.

* By default, the timings stats are Not included in the query results, to avoid the measuring overhead.

* __To include the query timings__ in the query results:  
  add a call to `Timings()` in your query code, or add `include timings()` to an RQL query.  
  See examples below.

* In this page:
    * [Include timings in a query](../../../../client-api/session/querying/debugging/query-timings.mdx#include-timings-in-a-query)
    * [View timings](../../../../client-api/session/querying/debugging/query-timings.mdx#view-timings)
    * [Syntax](../../../../client-api/session/querying/debugging/query-timings.mdx#syntax)
    * [Timings in a sharded database](../../../../client-api/session/querying/debugging/query-timings.mdx#timings-in-a-sharded-database)

</Admonition>
## Include timings in a query

<Tabs groupId='languageSyntax'>
<TabItem value="Query-sync" label="Query-sync">
<CodeBlock language="csharp">
{`// Define an object that will receive the query timings
QueryTimings timings = null;

var results = session.Query<Product>()
    // Use the Customize method to Call Timings, provide an out param for the timings results
    .Customize(x => x.Timings(out timings))
    // Define query criteria
    // i.e. search for docs containing Syrup -or- Lager in their Name field
    .Search(x => x.Name, "Syrup Lager")
    // Execute the query
    .ToList();

// Get total query duration:
// =========================
var totalQueryDuration = timings.DurationInMs;

// Get specific parts duration: 
// ============================
IDictionary<string, QueryTimings> timingsDictionary = timings.Timings;
var optimizerDuration = timingsDictionary["Optimizer"].DurationInMs;
var luceneDuration = timingsDictionary["Query"].Timings["Lucene"].DurationInMs;
`}
</CodeBlock>
</TabItem>
<TabItem value="Query-async" label="Query-async">
<CodeBlock language="csharp">
{`// Define an object that will receive the query timings
QueryTimings timings = null;

var results = await asyncSession.Query<Product>()
    // Use the Customize method to Call Timings, provide an out param for the timings results
    .Customize(x => x.Timings(out timings))
    // Define the search criteria
    // Search for docs containing Syrup -or- Lager in their Name field
    .Search(x => x.Name, "Syrup Lager")
    // Execute the query
    .ToListAsync();

// Get total query duration:
// =========================
var totalQueryDuration = timings.DurationInMs;

// Get specific parts duration: 
// ============================
IDictionary<string, QueryTimings> timingsDictionary = timings.Timings;
var optimizerDuration = timingsDictionary["Optimizer"].DurationInMs;
var luceneDuration = timingsDictionary["Query"].Timings["Lucene"].DurationInMs;
`}
</CodeBlock>
</TabItem>
<TabItem value="DocumentQuery-sync" label="DocumentQuery-sync">
<CodeBlock language="csharp">
{`var results = session.Advanced.DocumentQuery<Product>()
    // Call Timings, provide an out param for the timings results
    .Timings(out QueryTimings timings)
    // Define query criteria
    // i.e. search for docs containing Syrup -or- Lager in their Name field
    .Search(x => x.Name, "Syrup Lager")
    // Execute the query
    .ToList();

// Get total query duration:
// =========================
var totalQueryDuration = timings.DurationInMs;

// Get specific parts duration:
// ============================
IDictionary<string, QueryTimings> timingsDictionary = timings.Timings;
var optimizerDuration = timingsDictionary["Optimizer"].DurationInMs;
var luceneDuration = timingsDictionary["Query"].Timings["Lucene"].DurationInMs;
`}
</CodeBlock>
</TabItem>
<TabItem value="DocumentQuery-async" label="DocumentQuery-async">
<CodeBlock language="csharp">
{`var results = await asyncSession.Advanced.AsyncDocumentQuery<Product>()
    // Call Timings, provide an out param for the timings results
    .Timings(out QueryTimings timings)
     // Define the search criteria
     // Search for docs containing Syrup -or- Lager in their Name field
    .Search(x => x.Name, "Syrup Lager")
     // Execute the query
    .ToListAsync();

// Get total query duration:
// =========================
var totalQueryDuration = timings.DurationInMs;

// Get specific parts duration: 
// ============================
IDictionary<string, QueryTimings> timingsDictionary = timings.Timings;
var optimizerDuration = timingsDictionary["Optimizer"].DurationInMs;
var luceneDuration = timingsDictionary["Query"].Timings["Lucene"].DurationInMs;
`}
</CodeBlock>
</TabItem>
<TabItem value="RQL" label="RQL">
<CodeBlock language="sql">
{`from "Products"
where search(Name, "Syrup") or search(Name, "Lager")
include timings()
`}
</CodeBlock>
</TabItem>
</Tabs>



## View timings

* The detailed timings can be viewed from the [Query view](../../../../studio/database/queries/query-view.mdx) in the Studio.

* Running an RQL query with `include timings()` will show an additional __Timings Tab__  
  with a graphical representation of the time spent in each query part.

![Figure 1. Include timings graphical results](./assets/include-timings.png)



## Syntax

<TabItem value="syntax" label="syntax">
<CodeBlock language="csharp">
{`IDocumentQueryCustomization Timings(out QueryTimings timings);
`}
</CodeBlock>
</TabItem>

| Parameter   | Type           | Description                                                 |
|-------------|----------------|-------------------------------------------------------------|
| __timings__ | `QueryTimings` | An _out_ param that will be filled with the timings results |

| `QueryTimings`   |                                     |                                                   |
|------------------|-------------------------------------|---------------------------------------------------|
| __DurationInMs__ | `long`                              | Total duration                                    |
| __Timings__      | `IDictionary<string, QueryTimings>` | Dictionary with `QueryTimings` info per time part |



## Timings in a sharded database

* In a sharded database, timings for each part are provided __per shard__.

* Learn more in [timings in a sharded database](../../../../sharding/querying.mdx#timing-queries).



</LanguageContent>
<LanguageContent language="java">

<Admonition type="note" title="">

* When making a query,  
  you can request to get detailed stats of the time spent by RavenDB on each part of the query.  
  E.g. duration of search, loading documents, transforming results, total duration, etc.

* By default, the timings stats are Not included in the query results, to avoid the measuring overhead.

* __To include the query timings__ in the query results:  
  add a call to `timings()` in your query code, or add `include timings()` to an RQL query.  
  See examples below.

* In this page:
    * [Include timings in a query](../../../../client-api/session/querying/debugging/query-timings.mdx#include-timings-in-a-query)
    * [View timings](../../../../client-api/session/querying/debugging/query-timings.mdx#view-timings)
    * [Syntax](../../../../client-api/session/querying/debugging/query-timings.mdx#syntax)
    * [Timings in a sharded database](../../../../client-api/session/querying/debugging/query-timings.mdx#timings-in-a-sharded-database)

</Admonition>
## Include timings in a query

<Tabs groupId='languageSyntax'>
<TabItem value="Query" label="Query">
<CodeBlock language="java">
{`Reference<QueryTimings> timingsRef = new Reference<>();
List<Product> resultsWithTimings = session.advanced().documentQuery(Product.class)
    .timings(timingsRef)
    .search("Name", "Syrup")
    .toList();

Map<String, QueryTimings> timingsMap = timingsRef.value.getTimings();
`}
</CodeBlock>
</TabItem>
<TabItem value="RQL" label="RQL">
<CodeBlock language="sql">
{`from "Products"
where search(Name, "Syrup") or search(Name, "Lager")
include timings()
`}
</CodeBlock>
</TabItem>
</Tabs>



## View timings

* The detailed timings can be viewed from the [Query view](../../../../studio/database/queries/query-view.mdx) in the Studio.

* Running an RQL query with `include timings()` will show an additional __Timings Tab__  
  with a graphical representation of the time spent in each query part.

![Figure 1. Include timings graphical results](./assets/include-timings.png)



## Syntax

<TabItem value="timing_1" label="timing_1">
<CodeBlock language="java">
{`IDocumentQueryCustomization timings(Reference<QueryTimings> timings);
`}
</CodeBlock>
</TabItem>

The `QueryTimings` object will be filled with the timings when the query returns.  

| `QueryTimings`   |                             |                                                   |
|------------------|-----------------------------|---------------------------------------------------|
| __durationInMs__ | `long`                   | Total duration                                    |
| __timings__      | `Map<String, QueryTimings>` | Dictionary with `QueryTimings` info per time part |



## Timings in a sharded database

* In a sharded database, timings for each part are provided __per shard__.

* Learn more in [timings in a sharded database](../../../../sharding/querying.mdx#timing-queries).



</LanguageContent>
<LanguageContent language="python">

<Admonition type="note" title="">

* When making a query,   
  you can request to get detailed stats of the time spent by RavenDB on each part of the query.  
  E.g. duration of search, loading documents, transforming results, total duration, etc.

* By default, the timings stats are Not included in the query results, to avoid the measuring overhead.

* **To include the query timings** in the query results:  
  add a call to the `timings()` method in your query code, or add `include timings()` to an RQL query.  
  See examples below.

* In this page:
    * [Include timings in a query](../../../../client-api/session/querying/debugging/query-timings.mdx#include-timings-in-a-query)
    * [View timings](../../../../client-api/session/querying/debugging/query-timings.mdx#view-timings)
    * [Syntax](../../../../client-api/session/querying/debugging/query-timings.mdx#syntax)
    * [Timings in a sharded database](../../../../client-api/session/querying/debugging/query-timings.mdx#timings-in-a-sharded-database)

</Admonition>
## Include timings in a query

<Tabs groupId='languageSyntax'>
<TabItem value="Query" label="Query">
<CodeBlock language="python">
{`timings: Optional[QueryTimings] = None

# Prepare a callback
def timings_callback(timings_from_server: QueryTimings):
    timings = timings_from_server

results = list(
    session.advanced.document_query(object_type=Product)
    # Call timings, provide a callback function that will be called with result timings
    .timings(timings_callback)
    # Define query criteria
    # i.e. search for docs containing Syrup -or- Lager in their Name field
    .search("Name", "Syrup Lager")
    # Execute the query
)

# Get total query duration:
# =========================
total_query_duration = timings.duration_in_ms

# Get specific parts duration:
# ============================
timings_dictionary = timings.timings
optimizer_duration = timings_dictionary["Optimizer"].duration_in_ms
lucene_duration = timings_dictionary["Query"].timings["lucene"].duration_in_ms
`}
</CodeBlock>
</TabItem>
<TabItem value="RQL" label="RQL">
<CodeBlock language="sql">
{`from "Products"
where search(Name, "Syrup") or search(Name, "Lager")
include timings()
`}
</CodeBlock>
</TabItem>
</Tabs>



## View timings

* The detailed timings can be viewed from the [Query view](../../../../studio/database/queries/query-view.mdx) in the Studio.

* Running an RQL query with `include timings()` will show an additional **Timings Tab**  
  with a graphical representation of the time spent in each query part.

![Figure 1. Include timings graphical results](./assets/include-timings.png)



## Syntax

<TabItem value="syntax" label="syntax">
<CodeBlock language="python">
{`def timings(self, timings_callback: Callable[[QueryTimings], None]) -> DocumentQuery[_T]: ...
`}
</CodeBlock>
</TabItem>

| Parameter   | Type           | Description   |
|-------------|----------------|---------------|
| **timings_callback** | `Callable[[QueryTimings], None]` | A callback function (action) that takes `QueryTimings` as an argument. It will be called by the client with the resulting `QueryTimings`. You can interact with the resulting `QueryTimings` inside your callback. |

<TabItem value="syntax_2" label="syntax_2">
<CodeBlock language="python">
{`class QueryTimings:
    def __init__(self, duration_in_ms: int = None, timings: Dict[str, QueryTimings] = None):
        self.duration_in_ms = duration_in_ms
        self.timings = timings or \{\}
`}
</CodeBlock>
</TabItem>

| `QueryTimings`   |                                     |                                                   |
|------------------|-------------------------------------|---------------------------------------------------|
| **duration_in_ms** | `int` | Total duration |
| **timings**      | `Dict[str, QueryTimings]` | Dictionary with `QueryTimings` info per time part |



## Timings in a sharded database

* In a sharded database, timings for each part are provided **per shard**.

* Learn more in [timings in a sharded database](../../../../sharding/querying.mdx#timing-queries).



</LanguageContent>
<LanguageContent language="php">

<Admonition type="note" title="">

* When making a query,   
  you can request to get detailed stats of the time spent by RavenDB on each part of the query.  
  E.g. duration of search, loading documents, transforming results, total duration, etc.

* By default, the timings stats are Not included in the query results, to avoid the measuring overhead.

* **To include the query timings** in the query results:  
  add a call to the `timings()` method in your query code, or add `include timings()` to an RQL query.  
  See examples below.

* In this page:
    * [Include timings in a query](../../../../client-api/session/querying/debugging/query-timings.mdx#include-timings-in-a-query)
    * [View timings](../../../../client-api/session/querying/debugging/query-timings.mdx#view-timings)
    * [Syntax](../../../../client-api/session/querying/debugging/query-timings.mdx#syntax)
    * [Timings in a sharded database](../../../../client-api/session/querying/debugging/query-timings.mdx#timings-in-a-sharded-database)

</Admonition>
## Include timings in a query

<Tabs groupId='languageSyntax'>
<TabItem value="query" label="query">
<CodeBlock language="php">
{`$timings = new QueryTimings();

/** @var array<Product> $resultsWithTimings */
$resultsWithTimings = $session->advanced()->documentQuery(Product::class)
    ->timings($timings)
    ->search("Name", "Syrup")
    ->toList();

/** @var array<QueryTimings> $timingsMap */
$timingsMap = $timings->getTimings();
`}
</CodeBlock>
</TabItem>
<TabItem value="RQL" label="RQL">
<CodeBlock language="sql">
{`from "Products"
where search(Name, "Syrup") or search(Name, "Lager")
include timings()
`}
</CodeBlock>
</TabItem>
</Tabs>



## View timings

* The detailed timings can be viewed from Studio's [Query view](../../../../studio/database/queries/query-view.mdx).

* Running an RQL query with `include timings()` will show an additional **Timings Tab**  
  with a graphical representation of the time spent in each query part.

![Figure 1. Include timings graphical results](./assets/include-timings.png)



## Syntax

<TabItem value="syntax" label="syntax">
<CodeBlock language="php">
{`function timings(QueryTimings &$timings): DocumentQueryInterface;
`}
</CodeBlock>
</TabItem>

| Parameter   | Type           | Description   |
|-------------|----------------|---------------|
| **&$timings** | `QueryTimings` | A callback function (action) that takes `QueryTimings` as an argument. It will be called by the client with the resulting `QueryTimings`. You can interact with the resulting `QueryTimings` inside your callback. |



## Timings in a sharded database

* In a sharded database, timings for each part are provided **per shard**.

* Learn more in [timings in a sharded database](../../../../sharding/querying.mdx#timing-queries).



</LanguageContent>
<LanguageContent language="nodejs">

<Admonition type="note" title="">

* When making a query,  
  you can request to get detailed stats of the time spent by RavenDB on each part of the query.  
  E.g. duration of search, loading documents, transforming results, total duration, etc.

* By default, the timings stats are Not included in the query results, to avoid the measuring overhead.

* __To include the query timings__ in the query results:  
  add a call to `timings()` in your query code, or add `include timings()` to an RQL query.  
  See examples below.

* In this page:
    * [Include timings in a query](../../../../client-api/session/querying/debugging/query-timings.mdx#include-timings-in-a-query)
    * [View timings](../../../../client-api/session/querying/debugging/query-timings.mdx#view-timings)
    * [Syntax](../../../../client-api/session/querying/debugging/query-timings.mdx#syntax)
    * [Timings in a sharded database](../../../../client-api/session/querying/debugging/query-timings.mdx#timings-in-a-sharded-database)

</Admonition>
## Include timings in a query

<Tabs groupId='languageSyntax'>
<TabItem value="Query" label="Query">
<CodeBlock language="js">
{`// Define an object that will receive the timings results
let timingsResults;

const results = await session.query({ collection: "Products" })
    // Call timings, pass a callback function
    // Output param 'timingsResults' will be filled with the timings details when query returns 
    .timings(t => timingsResults = t)
    // Define query criteria
    // i.e. search for docs containing Syrup -or- Lager in their Name field
    .search("Name", "Syrup Lager")
    // Execute the query
    .all();

// Get total query duration:
// =========================    
const totalQueryDuration = timingsResults.durationInMs;

// Get specific parts duration:
// ============================
const optimizerDuration = timingsResults.timings.optimizer.durationInMs;
// or: timingsResults.timings["optimizer"].durationInMs;    
const luceneDuration = timingsResults.timings.query.timings.lucene.durationInMs;
// or: timingsResults.timings["query"].timings.["lucene"].durationInMs;
`}
</CodeBlock>
</TabItem>
<TabItem value="RQL" label="RQL">
<CodeBlock language="sql">
{`from "Products"
where search(Name, "Syrup") or search(Name, "Lager")
include timings()
`}
</CodeBlock>
</TabItem>
</Tabs>



## View timings

* The detailed timings can be viewed from the [Query view](../../../../studio/database/queries/query-view.mdx) in the Studio.

* Running an RQL query with `include timings()` will show an additional __Timings Tab__  
  with a graphical representation of the time spent in each query part.

![Figure 1. Include timings graphical results](./assets/include-timings.png)



## Syntax

<TabItem value="syntax" label="syntax">
<CodeBlock language="js">
{`query.timings(timingsCallback)
`}
</CodeBlock>
</TabItem>

| Parameter           | Type                        | Description                                                                                                                                                                    |
|---------------------|-----------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| __timingsCallback__ | `(timingsCallback) => void` | &lt;ul&gt;&lt;li&gt;A callback function with an output parameter.&lt;/li&gt;&lt;li&gt;The parameter passed to the callback will be filled with the `QueryTimings` object when query returns.&lt;/li&gt;&lt;/ul&gt; |

| `QueryTimings`   |                                |                                                   |
|------------------|--------------------------------|---------------------------------------------------|
| __durationInMs__ | `number`                       | Total duration                                    |
| __timings__      | `Record<string, QueryTimings>` | Dictionary with `QueryTimings` info per time part |



## Timings in a sharded database

* In a sharded database, timings for each part are provided __per shard__.

* Learn more in [timings in a sharded database](../../../../sharding/querying.mdx#timing-queries).



</LanguageContent>

<!---

-->