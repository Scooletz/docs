---
title: "Data Subscriptions: How to Create a Data Subscription"
hide_table_of_contents: true
sidebar_label: How to Create a Data Subscription
sidebar_position: 0
---

import Admonition from '@theme/Admonition';
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import CodeBlock from '@theme/CodeBlock';
import LanguageSwitcher from "@site/src/components/LanguageSwitcher";
import LanguageContent from "@site/src/components/LanguageContent";

export const supportedLanguages = ["csharp", "java", "nodejs"];


# Data Subscriptions: How to Create a Data Subscription
<LanguageSwitcher supportedLanguages={supportedLanguages} />
<LanguageContent language="csharp">

<Admonition type="note" title="">

Subscriptions are created by performing a request to the server with certain subscription creations parameters, see [Creation API summary](api-overview#create-and-createasync-overloads-summary).  
Once created, it's definition and progress will be stored on the cluster, and not in a single server.  
Upon subscription creation, the cluster will choose a preferred node that will run the subscription (unless client has stated a mentor node).  
From that point and on, clients that will connect to a server in order to consume the subscription will be redirected to the node mentioned above.  

In this page:  

[Subscription creation prerequisites](../../../client-api/data-subscriptions/creation/how-to-create-data-subscription.mdx#subscription-creation-prerequisites)   
[Subscription name](../../../client-api/data-subscriptions/creation/how-to-create-data-subscription.mdx#subscription-name)  
[Responsible node](../../../client-api/data-subscriptions/creation/how-to-create-data-subscription.mdx#responsible-node)  

</Admonition>
## Subscription creation prerequisites

Data subscription is a batch processing mechanism, that send the clients documents that answer a specific criteria.  
In order to create a data subscription, we first need to define the criteria. The minimum is to provide the collection to which the data subscription belongs.
However, the criteria can be a complex RQL-like expression defining JavaScript functions for the filtering and the projections. See a simple example:

<TabItem value="create_whole_collection_generic1" label="create_whole_collection_generic1">
<CodeBlock language="csharp">
{`// With the following subscription definition, the server will send ALL documents
// from the 'Orders' collection to a client that connects to this subscription.
subscriptionName = store.Subscriptions.Create<Order>();
`}
</CodeBlock>
</TabItem>

Fore more complex usage examples see [examples](../../../client-api/data-subscriptions/creation/examples.mdx)  



## Subscription name

Another important, but not mandatory subscription property is its name: 

<TabItem value="create_whole_collection_generic_with_name" label="create_whole_collection_generic_with_name">
<CodeBlock language="csharp">
{`subscriptionName = store.Subscriptions.Create<Order>(new SubscriptionCreationOptions<Order>
\{
    // Set a custom name for the subscription 
    Name = "OrdersProcessingSubscription"
\});
`}
</CodeBlock>
</TabItem>

In order to consume a data subscription, a subscription name is required to identify it.  
By default, the server can generate a subscription name by its own, but it's also possible to pass a custom name. 
A dedicated name can be useful for use cases like dedicated, long running batch processing mechanisms, where it'll be more comfortable to use a human readable
name in the code and even use the same name between different environments (as long as subscription creation is taken care of up front).

<Admonition type="info" title="Uniqueness" id="uniqueness" href="#uniqueness">
Note that subscription name is unique and it will not be possible to create two subscriptions with the same name in the same database.
</Admonition>



## Responsible node

As stated above, upon creation, the cluster will choose a node that will be responsible for the data subscription server side processing.  Once chosen, that node
will be the node that will the only node to process the subscription. There is an enterprise license level feature that support subscription (and any other ongoing task) 
failover between nodes, but eventually, as long as the originally assigned node is online, it will be the one to process the data subscription.  
Nevertheless, there is an option to manually decide the node that will be responsible for the subscription processing, it's called the `MentorNode`:

<TabItem value="create_whole_collection_generic_with_mentor_node" label="create_whole_collection_generic_with_mentor_node">
<CodeBlock language="csharp">
{`subscriptionName = store.Subscriptions.Create(new SubscriptionCreationOptions<Order>
\{
    MentorNode = "D"
\});
`}
</CodeBlock>
</TabItem>

The mentor node receives the responsible node tag, as can be seen in the subscription topology.  
Setting that node manually can help manually choosing a more fitting server from resources, client proximity or any other point of view.




</LanguageContent>
<LanguageContent language="java">

<Admonition type="note" title="">

Subscriptions are created by performing a request to the server with certain subscription creations parameters, see [Creation API summary](api-overview#create-and-createasync-overloads-summary).  
Once created, it's definition and progress will be stored on the cluster, and not in a single server.  
Upon subscription creation, the cluster will choose a preferred node that will run the subscription (unless client has stated a mentor node).  
From that point and on, clients that will connect to a server in order to consume the subscription will be redirected to the node mentioned above.  

In this page:  

[Subscription creation prerequisites](../../../client-api/data-subscriptions/creation/how-to-create-data-subscription.mdx#subscription-creation-prerequisites)   
[Subscription name](../../../client-api/data-subscriptions/creation/how-to-create-data-subscription.mdx#subscription-name)  
[Responsible node](../../../client-api/data-subscriptions/creation/how-to-create-data-subscription.mdx#responsible-node)  

</Admonition>
## Subscription creation prerequisites

Data subscription is a batch processing mechanism, that send the clients documents that answer a specific criteria.  
In order to create a data subscription, we first need to define the criteria. The minimum is to provide the collection to which the data subscription belongs.
However, the criteria can be a complex RQL-like expression defining JavaScript functions for the filtering and the projections. See a simple example:

<TabItem value="create_whole_collection_generic1" label="create_whole_collection_generic1">
<CodeBlock language="java">
{`// With the following subscription definition, the server will send ALL documents
// from the 'Orders' collection to a client that connects to this subscription.
name = store.subscriptions().create(Order.class);
`}
</CodeBlock>
</TabItem>

Fore more complex usage examples see [examples](../../../client-api/data-subscriptions/creation/examples.mdx)  



## Subscription name

Another important, but not mandatory subscription property is its name: 

<TabItem value="create_whole_collection_generic_with_name" label="create_whole_collection_generic_with_name">
<CodeBlock language="java">
{`SubscriptionCreationOptions options = new SubscriptionCreationOptions();
options.setName("OrdersProcessingSubscription");
name = store.subscriptions().create(Order.class, options);
`}
</CodeBlock>
</TabItem>

In order to consume a data subscription, a subscription name is required to identify it.  
By default, the server can generate a subscription name by its own, but it's also possible to pass a custom name. 
A dedicated name can be useful for use cases like dedicated, long running batch processing mechanisms, where it'll be more comfortable to use a human readable
name in the code and even use the same name between different environments (as long as subscription creation is taken care of up front).

<Admonition type="info" title="Uniqueness" id="uniqueness" href="#uniqueness">
Note that subscription name is unique and it will not be possible to create two subscriptions with the same name in the same database.
</Admonition>



## Responsible node

As stated above, upon creation, the cluster will choose a node that will be responsible for the data subscription server side processing.  Once chosen, that node
will be the node that will the only node to process the subscription. There is an enterprise license level feature that support subscription (and any other ongoing task) 
failover between nodes, but eventually, as long as the originally assigned node is online, it will be the one to process the data subscription.  
Nevertheless, there is an option to manually decide the node that will be responsible for the subscription processing, it's called the `MentorNode`:

<TabItem value="create_whole_collection_generic_with_mentor_node" label="create_whole_collection_generic_with_mentor_node">
<CodeBlock language="java">
{`SubscriptionCreationOptions options = new SubscriptionCreationOptions();
options.setMentorNode("D");
name = store.subscriptions().create(Order.class, options);
`}
</CodeBlock>
</TabItem>

The mentor node receives the responsible node tag, as can be seen in the subscription topology.  
Setting that node manually can help manually choosing a more fitting server from resources, client proximity or any other point of view.




</LanguageContent>
<LanguageContent language="nodejs">

<Admonition type="note" title="">

Subscriptions are created by performing a request to the server with certain subscription creations parameters, see [Creation API summary](api-overview#create-and-createasync-overloads-summary).  
Once created, it's definition and progress will be stored on the cluster, and not in a single server.  
Upon subscription creation, the cluster will choose a preferred node that will run the subscription (unless client has stated a mentor node).  
From that point and on, clients that will connect to a server in order to consume the subscription will be redirected to the node mentioned above.  

In this page:  

[Subscription creation prerequisites](../../../client-api/data-subscriptions/creation/how-to-create-data-subscription.mdx#subscription-creation-prerequisites)   
[Subscription name](../../../client-api/data-subscriptions/creation/how-to-create-data-subscription.mdx#subscription-name)  
[Responsible node](../../../client-api/data-subscriptions/creation/how-to-create-data-subscription.mdx#responsible-node)  

</Admonition>
## Subscription creation prerequisites

Data subscription is a batch processing mechanism, that send the clients documents that answer a specific criteria.  
In order to create a data subscription, we first need to define the criteria. The minimum is to provide the collection to which the data subscription belongs.
However, the criteria can be a complex RQL-like expression defining JavaScript functions for the filtering and the projections. See a simple example (in which collection name is determined based on the entity type):

<TabItem value="create_whole_collection_generic1" label="create_whole_collection_generic1">
<CodeBlock language="js">
{`// With the following subscription definition, the server will send ALL documents
// from the 'Orders' collection to a client that connects to this subscription.
const subscriptionName = await documentStore.subscriptions.create(\{
    query: "from Orders"
\});
`}
</CodeBlock>
</TabItem>

Fore more complex usage examples see [examples](../../../client-api/data-subscriptions/creation/examples.mdx)  



## Subscription name

Another important, but not mandatory subscription property is its name: 

<TabItem value="create_whole_collection_generic_with_name" label="create_whole_collection_generic_with_name">
<CodeBlock language="js">
{`const name = await store.subscriptions.create(\{
    query: "from Orders",
    // Set a custom name for the subscription 
    name: "OrdersProcessingSubscription"
\});
`}
</CodeBlock>
</TabItem>

In order to consume a data subscription, a subscription name is required to identify it.  
By default, the server can generate a subscription name by its own, but it's also possible to pass a custom name. 
A dedicated name can be useful for use cases like dedicated, long running batch processing mechanisms, where it'll be more comfortable to use a human readable
name in the code and even use the same name between different environments (as long as subscription creation is taken care of up front).

<Admonition type="info" title="Uniqueness" id="uniqueness" href="#uniqueness">
Note that subscription name is unique and it will not be possible to create two subscriptions with the same name in the same database.
</Admonition>



## Responsible node

As stated above, upon creation, the cluster will choose a node that will be responsible for the data subscription server side processing.  Once chosen, that node
will be the node that will the only node to process the subscription. There is an enterprise license level feature that support subscription (and any other ongoing task) 
failover between nodes, but eventually, as long as the originally assigned node is online, it will be the one to process the data subscription.  
Nevertheless, there is an option to manually decide the node that will be responsible for the subscription processing, it's called the `MentorNode`:

<TabItem value="create_whole_collection_generic_with_mentor_node" label="create_whole_collection_generic_with_mentor_node">
<CodeBlock language="js">
{`const name = await store.subscriptions.create(\{
    query: "from Orders",
    // Set a responsible node for the subscritpion task 
    mentorNode: "D"
\});
`}
</CodeBlock>
</TabItem>

The mentor node receives the responsible node tag, as can be seen in the subscription topology.  
Setting that node manually can help manually choosing a more fitting server from resources, client proximity or any other point of view.




</LanguageContent>

<!---
### Data Subscriptions:
- [What are Data Subscriptions](../../../client-api/data-subscriptions/what-are-data-subscriptions)
- [How to Consume a Data Subscription](../../../client-api/data-subscriptions/consumption/how-to-consume-data-subscription)

### Knowledge Base:
- [JavaScript Engine](../../../server/kb/javascript-engine)


-->