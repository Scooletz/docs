import Admonition from '@theme/Admonition';
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import CodeBlock from '@theme/CodeBlock';

<Admonition type="note" title="">

* A **proximity search** retrieves documents containing search terms that are located within a specified distance from each other.
  The distance is measured by the number of intermediate terms.

* Use the `proximity` method when running a **full-text search** by the [search](../../../../client-api/session/querying/text-search/full-text-search.mdx) method.  

* In this page:
    * [Why use proximity search](../../../../client-api/session/querying/text-search/proximity-search.mdx#why-use-proximity-search)
    * [How proximity works](../../../../client-api/session/querying/text-search/proximity-search.mdx#how-proximity-works)
    * [Proximity search examples](../../../../client-api/session/querying/text-search/proximity-search.mdx#proximity-search-examples)
    * [Syntax](../../../../client-api/session/querying/text-search/proximity-search.mdx#syntax)

</Admonition>
## Why use proximity search

* A basic linguistic assumption is that the proximity of words implies a relationship between them.

* Proximity search helps match phrases while avoiding scattered or spread-out terms in the text.

* By limiting the search to only include matches where the terms are within the specified maximum proximity,  
  the search results can be more relevant than those with scattered terms.



## How proximity works

* When searching with some specified distance between search terms `term1` and `term2`:

    * Retrieved documents will contain text in which `term1` and `term2` are separated by  
      the maximum number of terms specified or less.

    * The search terms can be separated by fewer terms, but not more than the specified distance.

    * Only the terms generated by the [search analyzer](../../../../indexes/using-analyzers.mdx#ravendb) 
      are considered towards the count of the maximum distance.  
      Words or tokens that are Not part of the generated terms are Not included in the proximity calculation.

* Note:

    * Search criteria should contain at least 2 search terms.

    * Search terms must be simple string terms without wildcards.



## Proximity search examples

## Proximity search (0 distance)

<Tabs groupId='languageSyntax'>
<TabItem value="Query" label="Query">
<CodeBlock language="php">
{`/** @var array<Employee> $employees */
$employees = $session->advanced()
    ->documentQuery(Employee::class)
    // Make a full-text search with search terms
    ->search("Notes", "fluent french")
    // Call 'Proximity' with 0 distance
    ->proximity(0)
    ->toList();
`}
</CodeBlock>
</TabItem>
<TabItem value="RQL" label="RQL">
<CodeBlock language="sql">
{`from "Employees"
where proximity(search(Notes, "fluent french"), 0)
`}
</CodeBlock>
</TabItem>
</Tabs>

Running the above query on the Northwind sample data returns the following Employee documents:
`employees/2-A`  
`employees/5-A`  
`employees/9-A`  

Each resulting document has the text 'fluent in French' in its 'Notes' field.

The word "in" is not taken into account as it is Not part of the terms list generated
by the analyzer. (Search is case-insensitive in this case.)

<Admonition type="note" title="">
Documents containing text with the search terms appearing with no words between them
(e.g. "fluent french") will also be returned.
</Admonition>

## Proximity search (distance &gt; 0)

<Tabs groupId='languageSyntax'>
<TabItem value="Query" label="Query">
<CodeBlock language="php">
{`/** @var array<Employee> $employees */
$employees = $session->advanced()
    ->documentQuery(Employee::class)
    // Make a full-text search with search terms
    ->search("Notes", "fluent french")
    // Call 'Proximity' with distance 5
    ->proximity(4)
    ->toList();
`}
</CodeBlock>
</TabItem>
<TabItem value="RQL" label="RQL">
<CodeBlock language="sql">
{`from "Employees"
where proximity(search(Notes, "fluent french"), 5)
`}
</CodeBlock>
</TabItem>
</Tabs>

Running the above query on the Northwind sample data returns the following Employee documents:
`employees/2-A`  
`employees/5-A`  
`employees/6-A`  
`employees/9-A`  

This time document 'employees/6-A' was added to the previous results since it contains the phrase:
"fluent in Japanese and can read and write French"
where the search terms are separated by a count of 4 terms.

"in" & "and" are not taken into account as they are not part of the terms list generated
by the analyzer.(Search is case-insensitive in this case).
                


## Syntax

<TabItem value="syntax" label="syntax">
<CodeBlock language="php">
{`public function proximity(int $proximity): DocumentQueryInterface;
`}
</CodeBlock>
</TabItem>

| Parameter     | Type  | Description                                                                   |
|---------------|-------|-------------------------------------------------------------------------------|
| **$proximity** | `int` | The maximum number of terms between the search terms.<br/>Can be `0` or more. |




