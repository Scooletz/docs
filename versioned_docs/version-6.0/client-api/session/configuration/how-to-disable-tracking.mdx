---
title: "Disable Entity Tracking"
hide_table_of_contents: true
sidebar_label: Disable Tracking
sidebar_position: 5
---

import Admonition from '@theme/Admonition';
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import CodeBlock from '@theme/CodeBlock';
import LanguageSwitcher from "@site/src/components/LanguageSwitcher";
import LanguageContent from "@site/src/components/LanguageContent";

export const supportedLanguages = ["csharp", "python", "php", "nodejs"];


# Disable Entity Tracking
<LanguageSwitcher supportedLanguages={supportedLanguages} />
<LanguageContent language="csharp">

<Admonition type="note" title="">

* By default, each session tracks changes to all entities it has either stored, loaded, or queried for.  
  All changes are then persisted when `SaveChanges` is called.  

* Tracking can be disabled at various scopes:  
  for a specific entity, for entities returned by a query, for all entities in a session, or globally using conventions.

* In this article:
  * [Disable tracking changes for a specific entity](../../../client-api/session/configuration/how-to-disable-tracking.mdx#disable-tracking-changes-for-a-specific-entity)
  * [Disable tracking all entities in session](../../../client-api/session/configuration/how-to-disable-tracking.mdx#disable-tracking-all-entities-in-session)
  * [Disable tracking query results](../../../client-api/session/configuration/how-to-disable-tracking.mdx#disable-tracking-query-results)
  * [Customize tracking in conventions](../../../client-api/session/configuration/how-to-disable-tracking.mdx#customize-tracking-in-conventions)
  * [Using 'Include' in a NoTracking session will throw](../../../client-api/session/configuration/how-to-disable-tracking.mdx#using-)

</Admonition>
## Disable tracking changes for a specific entity

* You can prevent the session from persisting changes made to a specific entity by using `IgnoreChangesFor`.
* Once changes are ignored for the entity:
  * Any modifications made to the entity will be ignored by `SaveChanges`.
  * The session will still keep a reference to the entity to avoid repeated server requests.  
    Performing another `Load` for the same entity will Not generate another call to the server.

**Example**

<Tabs groupId='languageSyntax'>
<TabItem value="Sync" label="Sync">
<CodeBlock language="csharp">
{`// Load a product entity - the session will track the entity by default
Product product = session.Load<Product>("products/1-A");

// Call 'IgnoreChangesFor' to instruct the session to ignore changes made to this entity
session.Advanced.IgnoreChangesFor(product);

// The following change will be ignored by SaveChanges - it will not be persisted
product.UnitsInStock += 1;

session.SaveChanges();
`}
</CodeBlock>
</TabItem>
<TabItem value="Async" label="Async">
<CodeBlock language="csharp">
{`// Load a product entity - the session will track the entity by default
Product product = await asyncSession.LoadAsync<Product>("products/1-A");

// Call 'IgnoreChangesFor' to instruct the session to ignore changes made to this entity
asyncSession.Advanced.IgnoreChangesFor(product);

// The following change will be ignored by SaveChanges - it will not be persisted
product.UnitsInStock += 1;

await asyncSession.SaveChangesAsync();
`}
</CodeBlock>
</TabItem>
</Tabs>

**Syntax**

<TabItem value="syntax_1" label="syntax_1">
<CodeBlock language="csharp">
{`void IgnoreChangesFor(object entity);
`}
</CodeBlock>
</TabItem>

| Parameter  | Type     | Description                                          |
|------------|----------|------------------------------------------------------|
| **entity** | `object` | Instance of entity for which changes will be ignored |



## Disable tracking all entities in session

* Tracking can be disabled for all entities in the session's options.  
* When tracking is disabled for the session:  
  * Method `Store` will Not be available (an exception will be thrown if used).
  * Calling `Load` or `Query` will generate a call to the server and create new entities instances.  

<Tabs groupId='languageSyntax'>
<TabItem value="Sync" label="Sync">
<CodeBlock language="csharp">
{`using (IDocumentSession session = store.OpenSession(new SessionOptions
{
    // Disable tracking for all entities in the session's options
    NoTracking = true
}))
{
    // Load any entity, it will Not be tracked by the session
    Employee employee1 = session.Load<Employee>("employees/1-A");
    
    // Loading again from same document will result in a new entity instance
    Employee employee2 = session.Load<Employee>("employees/1-A");
    
    // Entities instances are not the same
    Assert.NotEqual(employee1, employee2);
}
`}
</CodeBlock>
</TabItem>
<TabItem value="Async" label="Async">
<CodeBlock language="csharp">
{`using (IAsyncDocumentSession asyncSession = store.OpenAsyncSession(new SessionOptions
{
    // Disable tracking for all entities in the session's options
    NoTracking = true
}))
{
    // Load any entity, it will Not be tracked by the session
    Employee employee1 = await asyncSession.LoadAsync<Employee>("employees/1-A");
    
    // Loading again from same document will result in a new entity instance
    Employee employee2 = await asyncSession.LoadAsync<Employee>("employees/1-A");

    // Entities instances are not the same
    Assert.NotEqual(employee1, employee2);
}
`}
</CodeBlock>
</TabItem>
</Tabs>



## Disable tracking query results

* Tracking can be disabled for all entities resulting from a query.

<Tabs groupId='languageSyntax'>
<TabItem value="Query-Sync" label="Query-Sync">
<CodeBlock language="csharp">
{`using (IDocumentSession session = store.OpenSession())
{
    // Define a query
    List<Employee> employeesResults = session.Query<Employee>()
        // Set NoTracking, all resulting entities will not be tracked
        .Customize(x => x.NoTracking())
        .Where(x => x.FirstName == "Robert")
        .ToList();

    // The following modification will not be tracked for SaveChanges
    Employee firstEmployee = employeesResults[0];
    firstEmployee.LastName = "NewName";
    
    // Change to 'firstEmployee' will not be persisted
    session.SaveChanges();
}
`}
</CodeBlock>
</TabItem>
<TabItem value="Query-Async" label="Query-Async">
<CodeBlock language="csharp">
{`using (IAsyncDocumentSession asyncSession = store.OpenAsyncSession())
{
    // Define a query
    List<Employee> employeesResults = asyncSession.Query<Employee>()
        // Set NoTracking, all resulting entities will not be tracked
        .Customize(x => x.NoTracking())
        .Where(x => x.FirstName == "Robert")
        .ToList();

    // The following modification will not be tracked for SaveChanges
    Employee firstEmployee = employeesResults[0];
    firstEmployee.LastName = "NewName";
    
    // Change to 'firstEmployee' will not be persisted
    await asyncSession.SaveChangesAsync();
}
`}
</CodeBlock>
</TabItem>
<TabItem value="DocumentQuery-Sync" label="DocumentQuery-Sync">
<CodeBlock language="csharp">
{`using (IDocumentSession session = store.OpenSession())
{
    // Define a query
    List<Employee> employeesResults = session.Advanced.DocumentQuery<Employee>()
        // Set NoTracking, all resulting entities will not be tracked
        .NoTracking()
        .Where(x => x.FirstName == "Robert")
        .ToList();

    // The following modification will not be tracked for SaveChanges
    Employee firstEmployee = employeesResults[0];
    firstEmployee.LastName = "NewName";
    
    // Change to 'firstEmployee' will not be persisted
    session.SaveChanges();
}
`}
</CodeBlock>
</TabItem>
<TabItem value="DocumentQuery-Async" label="DocumentQuery-Async">
<CodeBlock language="csharp">
{`using (IAsyncDocumentSession asyncSession = store.OpenAsyncSession())
{
    // Define a query
    List<Employee> employeesResults = asyncSession.Advanced.AsyncDocumentQuery<Employee>()
        // Set NoTracking, all resulting entities will not be tracked
        .NoTracking()
        .Where(x => x.FirstName == "Robert")
        .ToList();

    // The following modification will not be tracked for SaveChanges
    Employee firstEmployee = employeesResults[0];
    firstEmployee.LastName = "NewName";
    
    // Change to 'firstEmployee' will not be persisted
    await asyncSession.SaveChangesAsync();
}
`}
</CodeBlock>
</TabItem>
</Tabs>



## Customize tracking in conventions

* You can further customize and fine-tune which entities will not be tracked  
  by configuring the `ShouldIgnoreEntityChanges` convention method on the document store.
* This customization rule will apply to all sessions opened for this document store.

**Example**

<TabItem value="disable_tracking_4" label="disable_tracking_4">
<CodeBlock language="csharp">
{`using (var store = new DocumentStore()
\{
    // Define the 'ignore' convention on your document store
    Conventions =
    \{
        ShouldIgnoreEntityChanges =
            // Define for which entities tracking should be disabled 
            // Tracking will be disabled ONLY for entities of type Employee whose FirstName is Bob
            (session, entity, id) => (entity is Employee e) &&
                                     (e.FirstName == "Bob")
    \}
\}.Initialize())
\{
    using (IDocumentSession session = store.OpenSession())
    \{
        var employee1 = new Employee \{ Id = "employees/1", FirstName = "Alice" \};
        var employee2 = new Employee \{ Id = "employees/2", FirstName = "Bob" \};

        session.Store(employee1);      // This entity will be tracked
        session.Store(employee2);      // Changes to this entity will be ignored

        session.SaveChanges();         // Only employee1 will be persisted

        employee1.FirstName = "Bob";   // Changes to this entity will now be ignored
        employee2.FirstName = "Alice"; // This entity will now be tracked

        session.SaveChanges();         // Only employee2 is persisted
    \}
\}
`}
</CodeBlock>
</TabItem>

// todo .. async...

**Syntax**

<TabItem value="syntax_2" label="syntax_2">
<CodeBlock language="csharp">
{`public Func<InMemoryDocumentSessionOperations, object, string, bool> ShouldIgnoreEntityChanges;
`}
</CodeBlock>
</TabItem>

| Parameter                           | Description                                      |
|-------------------------------------|--------------------------------------------------|
| `InMemoryDocumentSessionOperations` | The session for which tracking is to be disabled |
| `object`                            | The entity for which tracking is to be disabled  |
| `string`                            | The entity's document ID                         |

| Return Type  | Description                                                             |
|--------------|-------------------------------------------------------------------------|
| `bool`       | `true` - Entity will Not be tracked<br/>`false` - Entity will be tracked |



## Using 'Include' in a NoTracking session will throw
 
* Attempting to use `Include` in a `NoTracking` session will throw an exception.

* Like other entities in a _NoTracking_ session, 
  the included items are not tracked and will not prevent additional server requests during subsequent _Load_ operations for the same data.
  To avoid confusion, _Include_ operations are disallowed during non-tracking session actions such as `Load` or `Query`. 

* This applies to all items that can be included -  
  e.g., documents, compare-exchange items, counters, revisions, and time series.
**Include when loading**:

<Tabs groupId='languageSyntax'>
<TabItem value="Sync" label="Sync">
<CodeBlock language="csharp">
{`using (IDocumentSession session = store.OpenSession(new SessionOptions
{
    // Working with a non-tracking session
    NoTracking = true
}))
{
    try
    {
        // Trying to include a related document when loading a document will throw:
        Product product1 = session
            .Include<Product>(x => x.Supplier)
            .Load<Product>("products/1-A");
        
        // The same applies when using the builder syntax:
        Product product2 = session.Load<Product>("products/1-A",
            builder => builder.IncludeDocuments(product => product.Supplier));
    }
    catch (InvalidOperationException e)
    {
        // An InvalidOperationException is expected here
    }
}
`}
</CodeBlock>
</TabItem>
<TabItem value="Async" label="Async">
<CodeBlock language="csharp">
{`using (IAsyncDocumentSession asyncSession = store.OpenAsyncSession(new SessionOptions
       {
           // Working with a non-tracking session
           NoTracking = true
       }))
{
    try
    {
        // Trying to include a related document when loading a document will throw:
        Product product = await asyncSession
            .Include<Product>(x => x.Supplier)
            .LoadAsync<Product>("products/1-A");
        
        // The same applies when using the builder syntax:
        Product product2 = await asyncSession.LoadAsync<Product>("products/1-A",
            builder => builder.IncludeDocuments(product => product.Supplier));
    }
    catch (InvalidOperationException e)
    {
        // An InvalidOperationException is expected here
    }
}
`}
</CodeBlock>
</TabItem>
</Tabs>

**Include when querying**:

<Tabs groupId='languageSyntax'>
<TabItem value="Sync" label="Sync">
<CodeBlock language="csharp">
{`using (IDocumentSession session = store.OpenSession(new SessionOptions
       {
           // Working with a non-tracking session
           NoTracking = true
       }))
{
    try
    {
        // Trying to include related documents in a query will throw
        var products = session
            .Query<Product>()
            .Include(x => x.Supplier)
            .ToList();
    }
    catch (InvalidOperationException e)
    {
        // An InvalidOperationException is expected here
    }
}
`}
</CodeBlock>
</TabItem>
<TabItem value="Async" label="Async">
<CodeBlock language="csharp">
{`using (IAsyncDocumentSession asyncSession = store.OpenAsyncSession(new SessionOptions
       {
           // Working with a non-tracking session
           NoTracking = true
       }))
{
    try
    {
        // Trying to include related documents when making a query will throw
        var products = await asyncSession
            .Query<Product>()
            .Include(x => x.Supplier)
            .ToListAsync();
    }
    catch (InvalidOperationException e)
    {
        // An InvalidOperationException is expected here
    }
}
`}
</CodeBlock>
</TabItem>
</Tabs>




</LanguageContent>
<LanguageContent language="python">

<Admonition type="note" title="">

* By default, each session tracks changes to all entities it has either stored, loaded, or queried for.  
  All changes are then persisted when `save_changes` is called.  

* Tracking can be disabled at various scopes:  
  for a specific entity, for entities returned by a query, for all entities in a session, or globally using conventions.

* In this article:
    * [Disable tracking changes for a specific entity](../../../client-api/session/configuration/how-to-disable-tracking.mdx#disable-tracking-changes-for-a-specific-entity)
    * [Disable tracking all entities in session](../../../client-api/session/configuration/how-to-disable-tracking.mdx#disable-tracking-all-entities-in-session)
    * [Disable tracking query results](../../../client-api/session/configuration/how-to-disable-tracking.mdx#disable-tracking-query-results)
    * [Customize tracking in conventions](../../../client-api/session/configuration/how-to-disable-tracking.mdx#customize-tracking-in-conventions)

</Admonition>
## Disable tracking changes for a specific entity

* You can prevent the session from persisting changes made to a specific entity by using `ignore_changes_for`.
* Once changes are ignored for the entity:
    * Any modifications made to the entity will be ignored by `save_changes`.
    * The session will still keep a reference to the entity to avoid repeated server requests.  
      Performing another `load` for the same entity will Not generate another call to the server.
  
**Example**

<TabItem value="disable_tracking_1" label="disable_tracking_1">
<CodeBlock language="python">
{`# Load a product entity - the session will track the entity by default
product = session.load("products/1-A", Product)

# Call 'ignore_changes_for' to instruct the session to ignore changes made to this entity
session.ignore_changes_for(product)

# The following change will be ignored by SaveChanges - it will not be persisted
product.units_in_stock += 1
session.save_changes()
`}
</CodeBlock>
</TabItem>

**Syntax**

<TabItem value="syntax_1" label="syntax_1">
<CodeBlock language="python">
{`def ignore_changes_for(self, entity: object) -> None: ...
`}
</CodeBlock>
</TabItem>

| Parameter  | Type     | Description                                          |
|------------|----------|------------------------------------------------------|
| **entity** | `object` | Instance of entity for which changes will be ignored |



## Disable tracking for all entities in a session

* Tracking can be disabled for all entities in the session's options.  
* When tracking is disabled for the session:  
  * Method `store` will Not be available (an exception will be thrown if used).
  * Calling `load` or `query` will generate a call to the server and create new entities instances.  

<TabItem value="disable_tracking_2" label="disable_tracking_2">
<CodeBlock language="python">
{`with store.open_session(
    SessionOptions(
        # Disable tracking for all entities in the session's options
        no_tracking=True
    )
):
    # Load any entity, it will Not be tracked by the session
    employee1 = session.load("employees/1-A", Employee)

    # Loading again from same document will result in a new entity instance
    employee2 = session.load("employees/1-A", Employee)

    # Entities instances are not the same
    self.assertNotEqual(employee1, employee2)
`}
</CodeBlock>
</TabItem>



## Disable tracking for query results

* Tracking can be disabled for all entities resulting from a query.

<Tabs groupId='languageSyntax'>
<TabItem value="Python" label="Python">
<CodeBlock language="python disable_tracking_3@clientapi\session\configuration\disabletracking.py /}">
{`with store.open_session() as session:
    # Define a query
    employees_results = list(
        session.advanced.document_query(object_type=Employee)
        # Set no_tracking, all resulting entities will not ne tracked
        .no_tracking().where_equals("FirstName", "Robert")
    )

    # The following modification will not be tracked for save_changes
    first_employee = employees_results[0]
    first_employee.last_name = "NewName"

    # Change to 'first_employee' will not be persisted
    session.save_changes()
`}
</CodeBlock>
</TabItem>
</Tabs>



## Customize tracking in conventions

* You can further customize and fine-tune which entities will not be tracked  
  by configuring the `should_ignore_entity_changes` convention method on the document store.
* This customization rule will apply to all sessions opened for this document store.
* Implement rules under your [ShouldIgnoreEntityChanges](../../../client-api/session/configuration/how-to-disable-tracking.mdx#syntax) subclass.  
  Apply the class's `check` method to control the ignore flow.

**Example**:

<TabItem value="disable_tracking_4" label="disable_tracking_4">
<CodeBlock language="python">
{`with DocumentStore() as store:
    # Define the 'ignore' convention on your document store:

    # Create a class that implements 'ravendb.documents.conventions.ShouldIgnoreEntityChanges'
    # and implement 'check' method - it's going to be called to check if entity should be ignored

    class MyCustomShouldIgnoreEntityChanges(ShouldIgnoreEntityChanges):
        def check(self, session_operations: DocumentSession, entity: object, document_id: str) -> bool:
            # Define for which entities tracking should be disabled
            # Tracking will be disabled ONLY for entities of type Employee whose FirstName is Bob
            return isinstance(entity, Employee) and entity.first_name == "Bob"

    store.conventions.should_ignore_entity_changes = MyCustomShouldIgnoreEntityChanges

    store.initialize()

    with store.open_session() as session:
        employee1 = Employee(first_name="Alice", Id="employees/1")
        employee2 = Employee(first_name="Bob", Id="employees/2")

        session.store(employee1)  # This entity will be tracked
        session.store(employee2)  # Changes to this entity will be ignored

        session.save_changes()

        employee1.first_name = "Bob"  # Changes to this entity will now be ignored
        employee2.first_name = "Alice"  # This entity will now be tracked

        session.save_changes()
`}
</CodeBlock>
</TabItem>

**Syntax**:

<TabItem value="syntax_2" label="syntax_2">
<CodeBlock language="python">
{`@should_ignore_entity_changes.setter
def should_ignore_entity_changes(self, value: ShouldIgnoreEntityChanges) -> None: ...

class ShouldIgnoreEntityChanges(ABC):
    @abstractmethod
    def check(
        self,
        session_operations: "InMemoryDocumentSessionOperations",
        entity: object,
        document_id: str,
    ) -> bool:
        pass
`}
</CodeBlock>
</TabItem>

| Parameter   | Type     | Description                                     |
|-------------|----------|-------------------------------------------------|
| entity      | `object` | The entity for which tracking is to be disabled |
| document_id | `str`    | The entity's document ID                        |

| Return Type   | Description                                                             |
|---------------|-------------------------------------------------------------------------|
| `bool`        | `True` - Entity will Not be tracked<br/>`False` - Entity will be tracked |




</LanguageContent>
<LanguageContent language="php">

<Admonition type="note" title="">

* By default, each session tracks changes to all entities it has either stored, loaded, or queried for.  
  All changes are then persisted when `saveChanges` is called.  

* Tracking can be disabled at various scopes:  
  for a specific entity, for entities returned by a query, for all entities in a session, or globally using conventions.

* In this article:
    * [Disable tracking changes for a specific entity](../../../client-api/session/configuration/how-to-disable-tracking.mdx#disable-tracking-changes-for-a-specific-entity)
    * [Disable tracking all entities in session](../../../client-api/session/configuration/how-to-disable-tracking.mdx#disable-tracking-all-entities-in-session)
    * [Disable tracking query results](../../../client-api/session/configuration/how-to-disable-tracking.mdx#disable-tracking-query-results)
    * [Customize tracking in conventions](../../../client-api/session/configuration/how-to-disable-tracking.mdx#customize-tracking-in-conventions)

</Admonition>
## Disable tracking changes for a specific entity

* You can prevent the session from persisting changes made to a specific entity by using `ignoreChangesFor`.
* Once changes are ignored for the entity:
    * Any modifications made to the entity will be ignored by `saveChanges`.
    * The session will still keep a reference to the entity to avoid repeated server requests.  
      Performing another `load` for the same entity will Not generate another call to the server.
  
**Example**

<TabItem value="disable_tracking_1" label="disable_tracking_1">
<CodeBlock language="php">
{`// Load a product entity - the session will track the entity by default
/** @var Product $product */
$product = $session->load(Product::class, "products/1-A");

// Call 'ignoreChangesFor' to instruct the session to ignore changes made to this entity
$session->advanced()->ignoreChangesFor($product);

// The following change will be ignored by saveChanges - it will not be persisted
$product->setUnitsInStock($product->getUnitsInStock() + 1);

$session->saveChanges();
`}
</CodeBlock>
</TabItem>



## Disable tracking for all entities in a session

* Tracking can be disabled for all entities in the session's options.  
* When tracking is disabled for the session:  
  * Method `store` will Not be available (an exception will be thrown if used).
  * Calling `load` or `query` will generate a call to the server and create new entities instances.  

<TabItem value="disable_tracking_2" label="disable_tracking_2">
<CodeBlock language="php">
{`$sessionOptions = new SessionOptions();
// Disable tracking for all entities in the session's options
$sessionOptions->setNoTracking(true);

$session = $store->openSession($sessionOptions);
try \{
    // Load any entity, it will Not be tracked by the session
    /** @var Employee $employee1 */
    $employee1 = $session->load(Employee::class, "employees/1-A");

    // Loading again from same document will result in a new entity instance
    $employee2 = $session->load(Employee::class, "employees/1-A");

    // Entities instances are not the same
    $this->assertNotEquals($employee1, $employee2);
\} finally \{
    $session->close();
\}
`}
</CodeBlock>
</TabItem>



## Disable tracking for query results

* Tracking can be disabled for all entities resulting from a query.

<Tabs groupId='languageSyntax'>
<TabItem value="query" label="query">
<CodeBlock language="php">
{`$session = $store->openSession();
try {
    // Define a query
    /** @var array<Employee> $employeesResults */
    $employeesResults = $session->query(Employee::class)
        // Set NoTracking, all resulting entities will not be tracked
        ->noTracking()
        ->whereEquals("FirstName", "Robert")
        ->toList();

    // The following modification will not be tracked for SaveChanges
    $firstEmployee = $employeesResults[0];
    $firstEmployee->setLastName("NewName");

    // Change to 'firstEmployee' will not be persisted
    $session->saveChanges();
} finally {
    $session->close();
}
`}
</CodeBlock>
</TabItem>
<TabItem value="documentQuery" label="documentQuery">
<CodeBlock language="php">
{`$session = $store->openSession();
try {
    // Define a query
    /** @var array<Employee> $employeesResults */
    $employeesResults = $session->advanced()->documentQuery(Employee::class)
        // Set NoTracking, all resulting entities will not be tracked
        ->noTracking()
        ->whereEquals("FirstName", "Robert")
        ->toList();

    // The following modification will not be tracked for SaveChanges
    $firstEmployee = $employeesResults[0];
    $firstEmployee->setLastName("NewName");

    // Change to 'firstEmployee' will not be persisted
    $session->saveChanges();
} finally {
    $session->close();
}
`}
</CodeBlock>
</TabItem>
</Tabs>



## Customize tracking in conventions

* You can further customize and fine-tune which entities will not be tracked  
  by configuring the `ShouldIgnoreEntityChanges` convention method on the document store.
* This customization will apply to all sessions opened for this document store.
* Use the `setShouldIgnoreEntityChanges` method to do so.  

#### Example:

<TabItem value="disable_tracking_4" label="disable_tracking_4">
<CodeBlock language="php">
{`// Define the 'ignore' convention on your document store
$conventions = new DocumentConventions();
$conventions->setShouldIgnoreEntityChanges(
// Define for which entities tracking should be disabled
// Tracking will be disabled ONLY for entities of type Employee whose FirstName is Bob
    function ($session, $entity, $id) \{
        return $entity instanceof Employee && $entity->getFirstName() == "Bob";
    \}
);

$store = new DocumentStore();
$store->setConventions($conventions);
$store->initialize();
try \{
    $session = $store->openSession();
    try \{
        $employee1 = new Employee();
        $employee1->setId("employees/1");
        $employee1->setFirstName("Alice");

        $employee2 = new Employee();
        $employee2->setId("employees/2");
        $employee2->setFirstName("Bob");

        $session->store($employee1);      // This entity will be tracked
        $session->store($employee2);      // Changes to this entity will be ignored

        $session->saveChanges();          // Only employee1 will be persisted

        $employee1->setFirstName("Bob");  // Changes to this entity will now be ignored
        $employee2->setFirstName("Alice");// This entity will now be tracked

        $session->saveChanges();          // Only employee2 is persisted
    \} finally \{
        $session->close();
    \}
\} finally \{
    $store->close();
\}
`}
</CodeBlock>
</TabItem>




</LanguageContent>
<LanguageContent language="nodejs">

<Admonition type="note" title="">

* By default, each session tracks changes to all entities it has either stored, loaded, or queried for.  
  All changes are then persisted when `saveChanges` is called.  

* Tracking can be disabled at various scopes:  
  for a specific entity, for entities returned by a query, for all entities in a session, or globally using conventions.

* In this article:
  * [Disable tracking changes for a specific entity](../../../client-api/session/configuration/how-to-disable-tracking.mdx#disable-tracking-changes-for-a-specific-entity)
  * [Disable tracking all entities in session](../../../client-api/session/configuration/how-to-disable-tracking.mdx#disable-tracking-all-entities-in-session)
  * [Disable tracking query results](../../../client-api/session/configuration/how-to-disable-tracking.mdx#disable-tracking-query-results)
  * [Customize tracking in conventions](../../../client-api/session/configuration/how-to-disable-tracking.mdx#customize-tracking-in-conventions)
  * [Using 'Include' in a NoTracking session will throw](../../../client-api/session/configuration/how-to-disable-tracking.mdx#using-)

</Admonition>
## Disable tracking changes for a specific entity

* You can prevent the session from persisting changes made to a specific entity by using `ignoreChangesFor`.
* Once changes are ignored for the entity:
    * Any modifications made to the entity will be ignored by `saveChanges`.
    * The session will still keep a reference to the entity to avoid repeated server requests.  
      Performing another `load` for the same entity will Not generate another call to the server.
  
**Example**

<TabItem value="disable_tracking_1" label="disable_tracking_1">
<CodeBlock language="js">
{`const session = documentStore.openSession();        

// Load a product entity - the session will track the entity by default
const product = await session.load("products/1-A");

// Call 'ignoreChangesFor' to instruct the session to ignore changes made to this entity
session.advanded.ignoreChangesFor(product);

// The following change will be ignored by SaveChanges - it will not be persisted
product.unitsInStock += 1;

await session.saveChanges();
`}
</CodeBlock>
</TabItem>

**Syntax**

<TabItem value="syntax_1" label="syntax_1">
<CodeBlock language="js">
{`session.advanced.ignoreChangesFor(entity);
`}
</CodeBlock>
</TabItem>

| Parameter  | Type     | Description                                          |
|------------|----------|------------------------------------------------------|
| **entity** | `object` | Instance of entity for which changes will be ignored |



## Disable tracking all entities in session

* Tracking can be disabled for all entities in the session's options.  
* When tracking is disabled for the session:  
  * Method `store` will Not be available (an exception will be thrown if used).
  * Calling `load` or `query` will generate a call to the server and create new entities instances.

<TabItem value="disable_tracking_2" label="disable_tracking_2">
<CodeBlock language="js">
{`const session = documentStore.openSession(\{
    // Disable tracking for all entities in the session's options
    noTracking: true
\});

// Load any entity, it will Not be tracked by the session
const employee1 = await session.load("employees/1-A");

// Loading again from same document will result in a new entity instance
const employee2 = await session.load("employees/1-A");

// Entities instances are not the same
assert.notStrictEqual(company1, company2);

// Calling saveChanges will throw an exception
await session.saveChanges();
`}
</CodeBlock>
</TabItem>



## Disable tracking query results

* Tracking can be disabled for all entities resulting from a query.

<TabItem value="disable_tracking_3" label="disable_tracking_3">
<CodeBlock language="js">
{`const session = documentStore.openSession();

// Define a query
const employeesResults = await session.query(\{ collection: "employees" \})
    .whereEquals("FirstName", "Robert")
     // Set noTracking, all resulting entities will not be tracked
    .noTracking()
    .all();

// The following modification will not be tracked for saveChanges
const firstEmployee = employeesResults[0];
firstEmployee.lastName = "NewName";

// Change to 'firstEmployee' will not be persisted
session.saveChanges();
`}
</CodeBlock>
</TabItem>



## Customize tracking in conventions

* You can further customize and fine-tune which entities will not be tracked  
  by configuring the `shouldIgnoreEntityChanges` convention method on the document store.
* This customization rule will apply to all sessions opened for this document store.

**Example**

<TabItem value="disable_tracking_4" label="disable_tracking_4">
<CodeBlock language="js">
{`const customStore = new DocumentStore();

// Define the 'ignore' convention on your document store
customStore.conventions.shouldIgnoreEntityChanges =
    (sessionOperations, entity, documentId) => \{
        // Define for which entities tracking should be disabled 
        // Tracking will be disabled ONLY for entities of type Employee whose firstName is Bob
        return entity instanceof Employee && entity.firstName === "Bob";
    \};
customStore.initialize();

const session = customStore.openSession();

const employee1 = new Employee();
employee1.firstName = "Alice";

const employee2 = new Employee();
employee2.firstName = "Bob";

await session.store(employee1, "employees/1-A"); // This entity will be tracked
await session.store(employee2, "employees/2-A"); // Changes to this entity will be ignored

await session.saveChanges();   // Only employee1 will be persisted

employee1.firstName = "Bob";   // Changes to this entity will now be ignored
employee2.firstName = "Alice"; // This entity will now be tracked

session.saveChanges();         // Only employee2 is persisted
`}
</CodeBlock>
</TabItem>

**Syntax**

<TabItem value="syntax_2" label="syntax_2">
<CodeBlock language="js">
{`store.conventions.shouldIgnoreEntityChanges = (sessionOperations, entity, documentId) => \{
    // Write your logic
    // return value:
    //     true - entity will not be tracked 
    //     false - entity will be tracked
\}
`}
</CodeBlock>
</TabItem>

| Parameter         | Type                                | Description                                      |
|-------------------|-------------------------------------|--------------------------------------------------|
| sessionOperations | `InMemoryDocumentSessionOperations` | The session for which tracking is to be disabled |
| entity            | `object`                            | The entity for which tracking is to be disabled  |
| documentId        | `string`                            | The entity's document ID                         |

| Return Type   | Description                                                             |
|---------------|-------------------------------------------------------------------------|
| `boolean`     | `true` - Entity will Not be tracked<br/>`false` - Entity will be tracked |



## Using 'include' in a noTracking session will throw

* Attempting to use `include` in a `noTracking` session will throw an exception.

* Like other entities in a _noTracking_ session,
  the included items are not tracked and will not prevent additional server requests during subsequent _load_ operations for the same data.
  To avoid confusion, _include_ operations are disallowed during non-tracking session actions such as `load` or `query`.

* This applies to all items that can be included -  
  e.g., documents, compare-exchange items, counters, revisions, and time series.
**Include when loading**:

<TabItem value="disable_tracking_5" label="disable_tracking_5">
<CodeBlock language="js">
{`const session = documentStore.openSession(\{
    // Working with a non-tracking session
    noTracking: true
\});

try \{
    // Trying to include a related document when loading a document will throw
    const product = await session
        .include("supplier")
        .load("products/1-A");
\}
catch (error) \{
    // An exception is expected here
\}
`}
</CodeBlock>
</TabItem>

**Include when querying**:

<TabItem value="disable_tracking_6" label="disable_tracking_6">
<CodeBlock language="js">
{`const session = documentStore.openSession(\{
    // Working with a non-tracking session
    noTracking: true
\});

try \{
    // Trying to include related documents in a query will throw
    const products = await session
        .query(\{ collection: 'products' \})
        .include("supplier")
        .all();
\}
catch (error) \{
    // An exception is expected here
\}
`}
</CodeBlock>
</TabItem>




</LanguageContent>

<!---
### Client API
- [Document Store Conventions](../../../client-api/configuration/conventions)

### Session
- [How to Ignore Entity Changes](../../../client-api/session/how-to/ignore-entity-changes)
- [What is a Session and How Does it Work](../../../client-api/session/what-is-a-session-and-how-does-it-work)
- [Opening a Session](../../../client-api/session/opening-a-session)
- [Storing Entities](../../../client-api/session/storing-entities)
- [Loading Entities](../../../client-api/session/loading-entities)
- [Saving Changes](../../../client-api/session/saving-changes)


-->