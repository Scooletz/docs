import Admonition from '@theme/Admonition';
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import CodeBlock from '@theme/CodeBlock';

The `AttachmentsFor` method returns a list of [attachments](../../document-extensions/attachments/what-are-attachments.mdx) in a given document as well as basic information like `Name` or `Size` about each of them.

<Tabs groupId='languageSyntax'>
<TabItem value="AttachmentsFor" label="AttachmentsFor">
<CodeBlock language="csharp">
{`IEnumerable<AttachmentName> AttachmentsFor(object doc);
`}
</CodeBlock>
</TabItem>
<TabItem value="AttachmentName" label="AttachmentName">
<CodeBlock language="csharp">
{`public string Name;

public string Hash;

public string ContentType;

public long Size;
`}
</CodeBlock>
</TabItem>
</Tabs>

## Creating an index using `AttachmentsFor()`

The `AttachmentsFor` method is available in `AbstractIndexCreationTask`.

<TabItem value="index" label="index">
<CodeBlock language="csharp">
{`_1
        public class Employees_ByAttachmentDetails : 
            AbstractIndexCreationTask<Employee, Employees_ByAttachmentDetails.IndexEntry>
        \{
            public class IndexEntry
            \{
                public string EmployeeName \{ get; set; \}
                
                public string[] AttachmentNames \{ get; set; \}
                public string[] AttachmentContentTypes \{ get; set; \}
                public long[] AttachmentSizes \{ get; set; \}
            \}

            public Employees_ByAttachmentDetails()
            \{
                Map = employees => from employee in employees
                    
                    // Call 'AttachmentsFor' to get attachments details
                    let attachments = AttachmentsFor(employee)
                    
                    select new IndexEntry()
                    \{
                        // Can index info from document properties:
                        EmployeeName = employee.FirstName + " " + employee.LastName,
                        
                        // Index DETAILS of attachments:
                        AttachmentNames = attachments.Select(x => x.Name).ToArray(),
                        AttachmentContentTypes = attachments.Select(x => x.ContentType).ToArray(),
                        AttachmentSizes = attachments.Select(x => x.Size).ToArray()
                    \};
            \}
        \}
`}
</CodeBlock>
</TabItem>

## Querying the index

<Tabs groupId='languageSyntax'>
<TabItem value="Sync" label="Sync">
<CodeBlock language="csharp">
{`//return all employees that have an attachment called "cv.pdf"
List<Employee> employees = session
    .Query<Employees_ByAttachmentNames.Result, Employees_ByAttachmentNames>()
    .Where(x => x.AttachmentNames.Contains("cv.pdf"))
    .OfType<Employee>()
    .ToList();
`}
</CodeBlock>
</TabItem>
<TabItem value="Async" label="Async">
<CodeBlock language="csharp">
{`//return all employees that have an attachment called "cv.pdf"
List<Employee> employees = await asyncSession
    .Query<Employees_ByAttachmentNames.Result, Employees_ByAttachmentNames>()
    .Where(x => x.AttachmentNames.Contains("cv.pdf"))
    .OfType<Employee>()
    .ToListAsync();
`}
</CodeBlock>
</TabItem>
<TabItem value="DocumentQuery" label="DocumentQuery">
<CodeBlock language="csharp">
{`//return all employees that have an attachment called "cv.pdf"
List<Employee> employees = session
    .Advanced
    .DocumentQuery<Employee, Employees_ByAttachmentNames>()
    .ContainsAny("AttachmentNames", new[] { "cv.pdf" })
    .ToList();
`}
</CodeBlock>
</TabItem>
</Tabs>


