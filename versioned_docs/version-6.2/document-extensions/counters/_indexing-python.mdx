import Admonition from '@theme/Admonition';
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import CodeBlock from '@theme/CodeBlock';

<Admonition type="note" title="">

* To index counters, create a [static index](../../indexes/creating-and-deploying.mdx#static-indexes) 
that inherits from `AbstractCountersIndexCreationTask` or `AbstractJavaScriptCountersIndexCreationTask`.  

* Auto-indexes for counters are not available at this time.  

* In this page:  
  * [Syntax](../../document-extensions/counters/indexing.mdx#syntax)  
  * [AbstractJavaScriptCountersIndexCreationTask](../../document-extensions/counters/indexing.mdx#section)  
  * [CounterNamesFor](../../document-extensions/counters/indexing.mdx#section)  

</Admonition>
## Syntax

To index counter values, create an index that inherits from `AbstractCountersIndexCreationTask` 
and use `map` as follows.  
<TabItem value="index_1" label="index_1">
<CodeBlock language="python">
{`class MyCounterIndex(AbstractCountersIndexCreationTask):
    def __init__(self):
        super().__init__()
        self.map = (
            "from counter in counters "
            "select new \{ likes = counter.Value, name = counter.Name, user = counter.DocumentId \}"
        )
`}
</CodeBlock>
</TabItem>
### AbstractJavaScriptCountersIndexCreationTask

Creating an index inheriting from `AbstractJavaScriptCountersIndexCreationTask` allows 
you to write your map and reduce functions in JavaScript.  
Learn more about JavaScript indexes [here](../../indexes/javascript-indexes.mdx).  

<TabItem value="csharp" label="csharp">
<CodeBlock language="csharp">
{`public class AbstractJavaScriptCountersIndexCreationTask : AbstractCountersIndexCreationTask
\{
    public HashSet<string> Maps;
    protected string Reduce;
\}
`}
</CodeBlock>
</TabItem>

| Property | Type | Description |
| - | - | - |
| **maps** | `Set[str]` | The set of javascript map functions |
| **reduce** | `str` | The javascript reduce function |

Example:  

<TabItem value="index_3" label="index_3">
<CodeBlock language="python">
{`class MyMultiMapCounterIndex(AbstractJavaScriptCountersIndexCreationTask):
    def __init__(self):
        super().__init__()
        self.maps = """
        counters.map('Blogposts', 'Likes', function (counter) \{
            return \{
                Likes: counter.Value,
                Name: counter.Name,
                Blog Post: counter.DocumentId
            \};
        \})
        """
`}
</CodeBlock>
</TabItem>
### `CounterNamesFor`

While indexes inheriting from `AbstractIndexCreationTask` cannot index counter _values_, the `CounterNamesFor` 
method is available which returns the names of all counters for a specified document:  

<TabItem value="syntax" label="syntax">
<CodeBlock language="python">
{`IEnumerable<string> CounterNamesFor(object doc);
`}
</CodeBlock>
</TabItem>

Example of index using `CounterNamesFor`:  

<TabItem value="index_0" label="index_0">
<CodeBlock language="python">
{`class Companies_ByCounterNames(AbstractIndexCreationTask):
    class Result:
        def __init__(self, counter_names: List[str] = None):
            self.counter_names = counter_names

    def __init__(self):
        super().__init__()
        self.map = (
            "from e in docs.Employees "
            "let counterNames = CounterNamesFor(e) "
            "select new \{ counter_names = counterNames.ToArray() \}"
        )
`}
</CodeBlock>
</TabItem>




