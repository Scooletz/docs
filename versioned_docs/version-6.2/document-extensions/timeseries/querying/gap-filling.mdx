---
title: "Data Gap Filling"
sidebar_label: Data Gap Filling
sidebar_position: 6
hide_table_of_contents: true
---

import Admonition from '@theme/Admonition';
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import CodeBlock from '@theme/CodeBlock';
import LanguageSwitcher from "@site/src/components/LanguageSwitcher";
import LanguageContent from "@site/src/components/LanguageContent";

export const supportedLanguages = ["csharp", "java", "nodejs"];


# Data Gap Filling
<LanguageSwitcher supportedLanguages={supportedLanguages} />
<LanguageContent language="csharp">

<Admonition type="note" title="Note">

* Time series queries can add extra data points into the gaps between entries. 
  These data points get values extrapolated from the entries on either side of 
  the gap. This is called _interpolation_.  

* There are two interpolation methods available:  
  1. Nearest - add values equal to the value of the nearest entry.  
  2. Linear - place the data points on a straight line between the entries on 
     either side.  

* In this page:  
  * [Syntax](../../../document-extensions/timeseries/querying/gap-filling#syntax)  
  * [Examples](../../../document-extensions/timeseries/querying/gap-filling#examples)  

</Admonition>
## Syntax

To add interpolation to a time series query, start by grouping the data by some 
unit.  
For example, suppose you have a time series with an entry for every hour, 
but several hours are missing (1am, 3pm, etc.), and you want to fill those 
gaps. You will want to group by 1 hour.  
Or suppose you have a time series with an entry for every hour, and you want to 
fill in the gap with one data point per minute: you will group by 1 minute.  
See [here](../../../document-extensions/timeseries/querying/aggregation-and-projections) 
to learn about aggregation in queries.  

Next, use:  

* For RQL queries: `interpolation()`  
* For LINQ queries: the `Interpolation` option in `TimeSeriesAggregationOptions`.  

The two interpolation modes are:  

1. **Nearest**: add entries with values equal to the closest time series entry 
before or after this data point. If the data point is exactly in the middle 
between two entries, the data point gets the value of the earlier entry.  

2. **Linear**: the data point is placed on a projected line between two entries. 
For example, if the entry for 1:00 PM has a value 100, and the entry for 2:00 PM 
has a value 130, the interpolated data point for 1:40 PM will have the value 120.  

One data point is added for each aggregated time unit that does not contain any 
values. When time series entries have multiple values, an interpolation will add 
one data point for each pair of values found on *both* sides of the gap.  



## Examples

<Tabs groupId='languageSyntax'>
<TabItem value="RQL" label="RQL">
<CodeBlock language="csharp">
{`var query = session.Advanced.RawQuery<TimeSeriesAggregationResult>(@"
    from People
    select timeseries(
        from HeartRates
        group by 1 second
        with interpolation(linear)
    ");
`}
</CodeBlock>
</TabItem>
<TabItem value="LINQ" label="LINQ">
<CodeBlock language="csharp">
{`var query = session.Query<People>()
    .Select(p => RavenQuery.TimeSeries(p, "HeartRates")
        .GroupBy(g => g
            .Hours(1)
            .WithOptions(new TimeSeriesAggregationOptions
            {
                Interpolation = InterpolationType.Linear
            }))
        .ToList());
`}
</CodeBlock>
</TabItem>
</Tabs>




</LanguageContent>
<LanguageContent language="java">

<Admonition type="note" title="Note">

* Time series queries can add extra data points into the gaps between entries. 
  These data points get values extrapolated from the entries on either side of 
  the gap. This is called _interpolation_.  

* There are two interpolation methods available:  
  1. Nearest - add values equal to the value of the nearest entry.  
  2. Linear - place the data points on a straight line between the entries on 
     either side.  

* In this page:  
  * [Syntax](../../../document-extensions/timeseries/querying/gap-filling#syntax)  
  * [Examples](../../../document-extensions/timeseries/querying/gap-filling#examples)  

</Admonition>
## Syntax

To add interpolation to a time series query, start by grouping the data by some 
unit.  
For example, suppose you have a time series with an entry for every hour, 
but several hours are missing (1am, 3pm, etc.), and you want to fill those 
gaps. You will want to group by 1 hour.  
Or suppose you have a time series with an entry for every hour, and you want to 
fill in the gap with one data point per minute: you will group by 1 minute.  
See [here](../../../document-extensions/timeseries/querying/aggregation-and-projections) 
to learn about aggregation in queries.  

Next, use:  

* For RQL queries: `interpolation()`  

The two interpolation modes are:  

1. **Nearest**: add entries with values equal to the closest time series entry 
before or after this data point. If the data point is exactly in the middle 
between two entries, the data point gets the value of the earlier entry.  

2. **Linear**: the data point is placed on a projected line between two entries. 
For example, if the entry for 1:00 PM has a value 100, and the entry for 2:00 PM 
has a value 130, the interpolated data point for 1:40 PM will have the value 120.  

One data point is added for each aggregated time unit that does not contain any 
values. When time series entries have multiple values, an interpolation will add 
one data point for each pair of values found on *both* sides of the gap.  



## Examples

<Tabs groupId='languageSyntax'>
<TabItem value="RQL" label="RQL">
<CodeBlock language="java">
{`IRawDocumentQuery<RawQueryResult> query = session.advanced().rawQuery(RawQueryResult.class, "declare timeseries out(p)\\n" +
        "{\\n" +
        "    from p.HeartRate between $start and $end\\n" +
        "    group by 1h\\n" +
        "    select min(), max()\\n" +
        "}\\n" +
        "from index 'People' as p\\n" +
        "where p.age > 49\\n" +
        "select out(p) as heartRate, p.name")
        .addParameter("start", baseLine)
        .addParameter("end", DateUtils.addDays(baseLine, 1));
`}
</CodeBlock>
</TabItem>
</Tabs>




</LanguageContent>
<LanguageContent language="nodejs">

<Admonition type="note" title="Note">

* Time series queries can add extra data points into the gaps between entries. 
  These data points get values extrapolated from the entries on either side of 
  the gap. This is called _interpolation_.  

* There are two interpolation methods available:  
  1. Nearest - add values equal to the value of the nearest entry.  
  2. Linear - place the data points on a straight line between the entries on 
     either side.  

* In this page:  
  * [Syntax](../../../document-extensions/timeseries/querying/gap-filling#syntax)  
  * [Examples](../../../document-extensions/timeseries/querying/gap-filling#examples)  

</Admonition>
## Syntax

To add interpolation to a time series query, start by grouping the data by some 
unit.  
For example, suppose you have a time series with an entry for every hour, 
but several hours are missing (1am, 3pm, etc.), and you want to fill those 
gaps. You will want to group by 1 hour.  
Or suppose you have a time series with an entry for every hour, and you want to 
fill in the gap with one data point per minute: you will group by 1 minute.  
See [here](../../../document-extensions/timeseries/querying/aggregation-and-projections) 
to learn about aggregation in queries.  

Next, use:  

* For RQL queries: `interpolation()`  

The two interpolation modes are:  

1. **Nearest**: add entries with values equal to the closest time series entry 
before or after this data point. If the data point is exactly in the middle 
between two entries, the data point gets the value of the earlier entry.  

2. **Linear**: the data point is placed on a projected line between two entries. 
For example, if the entry for 1:00 PM has a value 100, and the entry for 2:00 PM 
has a value 130, the interpolated data point for 1:40 PM will have the value 120.  

One data point is added for each aggregated time unit that does not contain any 
values. When time series entries have multiple values, an interpolation will add 
one data point for each pair of values found on *both* sides of the gap.  



## Examples

<TabItem value="something-something" label="rql_query">
<CodeBlock language="nodejs">
{`const query = session.advanced.rawQuery(
    "from People\\n" +
    "select timeseries(\\n" +
    "    from HeartRates\\n" +
    "    group by  1 second\\n" +
    "    with interpolation(liner)\\n" +
    ")", TimeSeriesAggregationResult
);
`}
</CodeBlock>
</TabItem>




</LanguageContent>

<!---
### Time Series Overview
- [Time Series Overview](../../../document-extensions/timeseries/overview)

### Studio Articles
- [Studio Time Series Management](../../../studio/database/document-extensions/time-series)

### Time Series Indexing
- [Time Series Indexing](../../../document-extensions/timeseries/indexing)

### Time Series Queries
- [Range Selection](../../../document-extensions/timeseries/querying/choosing-query-range)
- [Filtering](../../../document-extensions/timeseries/querying/filtering)
- [Aggregation and Projection](../../../document-extensions/timeseries/querying/aggregation-and-projections)

### Policies
- [Time Series Rollup and Retention](../../../document-extensions/timeseries/rollup-and-retention)


-->