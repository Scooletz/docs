---
title: "Revert Document to Revision Operation"
hide_table_of_contents: true
sidebar_label: Revert Document to Revision
sidebar_position: 4
---

import Admonition from '@theme/Admonition';
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import CodeBlock from '@theme/CodeBlock';
import LanguageSwitcher from "@site/src/components/LanguageSwitcher";
import LanguageContent from "@site/src/components/LanguageContent";

export const supportedLanguages = ["csharp"];


# Revert Document to Revision Operation
<LanguageSwitcher supportedLanguages={supportedLanguages} />
<LanguageContent language="csharp">

<Admonition type="note" title="">

* This article describes how to revert specific documents to specific revisions using the `RevertRevisionsByIdOperation` operation.

* To revert documents from all collections (or from selected collections) to a specified point in time,  
  see [Revert documents to revisions](../../../../document-extensions/revisions/revert-revisions.mdx). 

* By default, the operation will be applied to the [default database](../../../../client-api/setting-up-default-database.mdx).  
  To operate on a different database see [switch operations to different database](../../../../client-api/operations/how-to/switch-operations-to-a-different-database.mdx).  

* In this page:  
  * [Overview](../../../../document-extensions/revisions/client-api/operations/revert-document-to-revision.mdx#overview)
  * [Revert single document](../../../../document-extensions/revisions/client-api/operations/revert-document-to-revision.mdx#revert-single-document)
  * [Revert multiple documents](../../../../document-extensions/revisions/client-api/operations/revert-document-to-revision.mdx#revert-multiple-documents)
  * [Syntax](../../../../document-extensions/revisions/client-api/operations/revert-document-to-revision.mdx#syntax)  

</Admonition>
## Overview

* To revert a document to a specific revision, provide the document ID and the change-vector of the target revision to the `RevertRevisionsByIdOperation` operation.  
  The document content will be overwritten by the content of the specified revision.

* An exception will be thrown if the revision's change-vector is not found, does not exist for the specified document, or belongs to a different document.

* Reverting a document with this operation can be executed even if the revisions configuration is disabled:
  * When revisions are **enabled**:  
    Reverting the document creates a new revision containing the content of the target revision.  
  * When revisions are **disabled**:  
    The document is reverted to the target revision without creating a new revision.  

* In addition to the document itself, reverting will impact Document Extensions as follows:  
  * **Attachments**:  
    If the target revision owns attachments, they are restored to their state when the revision was created.  
  * **Counters**:  
    If the target revision owns counters, they are restored to functionality with their values at the time the revision was created.  
  * **Time series**:  
    Time series data is Not reverted. Learn more [here](../../../../document-extensions/revisions/revisions-and-other-features.mdx#reverted-data-1).

* When executing this operation on a document that had revisions and was deleted, placing it in the Revisions Bin,
  the document will be **recreated** with the content of the specified target revision and will be removed from the Revisions Bin.
##### How to obtain a revision's change-vector:  

The change-vector of a revision can be obtained via:  

  * The Client API - follow the code in the examples [below](../../../../document-extensions/revisions/client-api/operations/revert-document-to-revision.mdx#revert-single-document)  
  * Or from the document view in the Studio  

![Get revision CV](./assets/get-cv-for-revision.png)

1. Go to the Revisions tab in the document view.
2. Click a revision to view
3. The document view will display the content of the revision.  
   This top label indicates that you are viewing a revision and not the current document.
4. Click the copy button in the Properties pane to copy this revision's change-vector to your clipboard.



## Revert single document

Using RavenDB's sample data, document _orders/1-A_ has a total of 7 revisions.  
In this example, we revert document _orders/1-A_ to its very first revision.

<Tabs groupId='languageSyntax'>
<TabItem value="Sync" label="Sync">
<CodeBlock language="csharp">
{`using (var session = store.OpenSession())
{
    // Get the revisions metadata for the document you wish to revert
    // ==============================================================
    
    var revisionsMetadata = session.Advanced.Revisions
        .GetMetadataFor(id: "orders/1-A");

    // Get the CV of the revision you wish to revert to:
    // =================================================
    
    // Note: revisionsMetadata[0] is the latest revision,
    // so specify the index of the revision you want.
    // In this example, it will be the very first revision of the document:
    
    var numberOfRevisions = revisionsMetadata.Count();
    var changeVector = revisionsMetadata[numberOfRevisions-1]
        .GetString(Constants.Documents.Metadata.ChangeVector);

    // Execute the operation
    store.Operations.Send(
        // Pass the document ID and the change-vector of the revision to revert to
        new RevertRevisionsByIdOperation("orders/1-A", changeVector));
}
`}
</CodeBlock>
</TabItem>
<TabItem value="Async" label="Async">
<CodeBlock language="csharp">
{`using (var asyncSession = store.OpenAsyncSession())
{
    // Get the revisions metadata for the document you wish to revert
    // ==============================================================
    
    var revisionsMetadata = await asyncSession.Advanced.Revisions
        .GetMetadataForAsync(id: "Orders/1-A");
    
    // Get the CV of the revision you wish to revert to:
    // =================================================
    
    // Note: revisionsMetadata[0] is the latest revision,
    // so specify the index of the revision you want.
    // In this example, it will be the very first revision of the document:
    
    var numberOfRevisions = revisionsMetadata.Count();
    var changeVector = revisionsMetadata[numberOfRevisions-1]
        .GetString(Constants.Documents.Metadata.ChangeVector);

    // Execute the operation
    await store.Operations.SendAsync(
        // Pass the document ID and the change-vector of the revision to revert to
        new RevertRevisionsByIdOperation("Orders/1-A", changeVector));
}
`}
</CodeBlock>
</TabItem>
</Tabs>



## Revert multiple documents

You can use the operation to revert multiple documents.  
Note: The documents do not need to belong to the same collection.

<Tabs groupId='languageSyntax'>
<TabItem value="Sync" label="Sync">
<CodeBlock language="csharp">
{`using (var session = store.OpenSession())
{
    // Get the revisions metadata for the documents you wish to revert
    var revisionsMetadata1 = session.Advanced.Revisions
        .GetMetadataFor(id: "orders/1-A");
    var revisionsMetadata2 = session.Advanced.Revisions
        .GetMetadataFor(id: "users/999");

    // Get the CV of the revisions you wish to revert to
    var changeVector1 = revisionsMetadata1[2]
        .GetString(Constants.Documents.Metadata.ChangeVector);
    var changeVector2 = revisionsMetadata1[3]
        .GetString(Constants.Documents.Metadata.ChangeVector);

    // Execute the operation
    store.Operations.Send(
        // Pass the document IDs and the change-vector of the revisions to revert to
        new RevertRevisionsByIdOperation(new Dictionary<string, string>()
            { { "orders/1-A", changeVector1 }, { "users/999", changeVector2 } }));
}
`}
</CodeBlock>
</TabItem>
<TabItem value="Async" label="Async">
<CodeBlock language="csharp">
{`using (var asyncSession = store.OpenAsyncSession())
{
    // Get the revisions metadata for the documents you wish to revert
    var revisionsMetadata1 = await asyncSession.Advanced.Revisions
        .GetMetadataForAsync(id: "orders/1-A");
    var revisionsMetadata2 = await asyncSession.Advanced.Revisions
        .GetMetadataForAsync(id: "users/999");

    // Get the CV of the revisions you wish to revert to
    var changeVector1 = revisionsMetadata1[2]
        .GetString(Constants.Documents.Metadata.ChangeVector);
    var changeVector2 = revisionsMetadata1[3]
        .GetString(Constants.Documents.Metadata.ChangeVector);

    // Execute the operation
    await store.Operations.SendAsync(
        // Pass the document IDs and the change-vector of the revisions to revert to
        new RevertRevisionsByIdOperation(new Dictionary<string, string>()
            { { "orders/1-A", changeVector1 }, { "users/999", changeVector2 } }));
}
`}
</CodeBlock>
</TabItem>
</Tabs>



## Syntax

<TabItem value="syntax_1" label="syntax_1">
<CodeBlock language="csharp">
{`Available overloads:
====================
public RevertRevisionsByIdOperation(string id, string cv);
public RevertRevisionsByIdOperation(Dictionary<string, string> idToChangeVector);
`}
</CodeBlock>
</TabItem>

| Parameter            | Type                         | Description                                                                                                                                 |
|----------------------|------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------|
| **id**               | `string`                     | The ID of the document to revert.                                                                                                           |
| **cv**               | `string`                     | The change vector of the revision to which the document should be reverted.                                                                 |
| **idToChangeVector** | `Dictionary<string, string>` | A dictionary where each key is a document ID, and each value is the change-vector of the revision to which the document should be reverted. |




</LanguageContent>

<!---
### Document Extensions
- [Revisions Overview](../../../../document-extensions/revisions/overview)
- [Revert Documents to Revisions](../../../../document-extensions/revisions/revert-revisions)
- [Revisions and Other Features](../../../../document-extensions/revisions/revisions-and-other-features)
- [Revisions: API Overview](../../../../document-extensions/revisions/client-api/overview)

### Client API
- [What Are Operations](../../../../client-api/operations/what-are-operations)
- [Switch Operation Database](../../../../client-api/operations/how-to/switch-operations-to-a-different-database)
- [Setting Up a Default Database](../../../../client-api/setting-up-default-database)

### Studio
- [Settings: Document Revisions](../../../../studio/database/settings/document-revisions)
- [Document Extensions: Revisions](../../../../studio/database/document-extensions/revisions)


-->