---
title: "Highlight Search Results"
sidebar_label: Highlight Search Results
sidebar_position: 5
---

import Admonition from '@theme/Admonition';
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import CodeBlock from '@theme/CodeBlock';
import LanguageSwitcher from "@site/src/components/LanguageSwitcher";
import LanguageContent from "@site/src/components/LanguageContent";

export const supportedLanguages = ["java", "csharp", "python", "php", "nodejs"];


# Highlight Search Results
<LanguageSwitcher supportedLanguages={supportedLanguages} />
<LanguageContent language="java">


**Highlighting** can be a great feature for increasing search UX. To take leverage of it use `highlight` method.

## Syntax

<TabItem value="something-something" label="highlight_1">
<CodeBlock language="java">
{`IDocumentQuery<T> highlight(String fieldName,
                            int fragmentLength,
                            int fragmentCount,
                            Reference<Highlightings> highlightings);

IDocumentQuery<T> highlight(String fieldName,
                            int fragmentLength,
                            int fragmentCount,
                            HighlightingOptions options,
                            Reference<Highlightings> highlightings);
`}
</CodeBlock>
</TabItem>

| Parameters | | |
| ------------- | ------------- | ----- |
| **fieldName** | string | Name of a field to highlight. |
| **path** | string | Path to a field to highlight. |
| **fragmentLength** | int | Maximum length of text fragments that will be returned. |
| **fragmentCount** | int | Maximum number of fragments that will be returned. |
| **options** | `HighlightingOptions`  | Options that can be used for customization. |
| **highlightings** | `Highlightings` | Instance of a Highlightings that contains the highlight fragments for each returned result. |

### Options

<TabItem value="something-something" label="options">
<CodeBlock language="java">
{`private String groupKey;
private String[] preTags;
private String[] postTags;

// getters and setters
`}
</CodeBlock>
</TabItem>

| Options | | |
| ------------- | ------------- | ----- |
| **groupKey** | string | Grouping key for the results. If `null` results are grouped by document ID (default). |
| **preTags** | `string[]` | Array of pre tags used when highlighting. |
| **postTags** | `string[]` | Array of post tags used when highlighting. |

## Example

<Tabs groupId='languageSyntax'>
<TabItem value="Java" label="Java">
<CodeBlock language="java">
{`Reference<Highlightings> highlightingsRef = new Reference<>();
List<SearchItem> results = session
    .query(SearchItem.class, ContentSearchIndex.class)
    .highlight("text", 128, 1, highlightingsRef)
    .search("text", "raven")
    .toList();

StringBuilder builder = new StringBuilder();
builder.append("<ul>");

for (SearchItem result : results) {
    String[] fragments = highlightingsRef.value.getFragments(result.getId());
    builder.append("<li>")
        .append(fragments[0])
        .append("</li>");
}

builder.append("</ul>");
String ul = builder.toString();
`}
</CodeBlock>
</TabItem>
<TabItem value="RQL" label="RQL">
<CodeBlock language="sql">
{`from index 'ContentSearchIndex'
where search(text, 'raven')
include highlight(text, 128, 1)
`}
</CodeBlock>
</TabItem>
</Tabs>

## Remarks

<Admonition type="note" title="Note" id="note" href="#note">
Default `<b></b>` tags are coloured and colours are returned in following order:

- &lt;span style="border-left: 10px solid yellow"&gt;&nbsp;&lt;/span&gt;yellow,
- &lt;span style="border-left: 10px solid lawngreen"&gt;&nbsp;&lt;/span&gt;lawngreen,
- &lt;span style="border-left: 10px solid aquamarine"&gt;&nbsp;&lt;/span&gt;aquamarine,
- &lt;span style="border-left: 10px solid magenta"&gt;&nbsp;&lt;/span&gt;magenta,
- &lt;span style="border-left: 10px solid palegreen"&gt;&nbsp;&lt;/span&gt;palegreen,
- &lt;span style="border-left: 10px solid coral"&gt;&nbsp;&lt;/span&gt;coral,
- &lt;span style="border-left: 10px solid wheat"&gt;&nbsp;&lt;/span&gt;wheat,
- &lt;span style="border-left: 10px solid khaki"&gt;&nbsp;&lt;/span&gt;khaki,
- &lt;span style="border-left: 10px solid lime"&gt;&nbsp;&lt;/span&gt;lime,
- &lt;span style="border-left: 10px solid deepskyblue"&gt;&nbsp;&lt;/span&gt;deepskyblue,
- &lt;span style="border-left: 10px solid deeppink"&gt;&nbsp;&lt;/span&gt;deeppink,
- &lt;span style="border-left: 10px solid salmon"&gt;&nbsp;&lt;/span&gt;salmon,
- &lt;span style="border-left: 10px solid peachpuff"&gt;&nbsp;&lt;/span&gt;peachpuff,
- &lt;span style="border-left: 10px solid violet"&gt;&nbsp;&lt;/span&gt;violet,
- &lt;span style="border-left: 10px solid mediumpurple"&gt;&nbsp;&lt;/span&gt;mediumpurple,
- &lt;span style="border-left: 10px solid palegoldenrod"&gt;&nbsp;&lt;/span&gt;palegoldenrod,
- &lt;span style="border-left: 10px solid darkkhaki"&gt;&nbsp;&lt;/span&gt;darkkhaki,
- &lt;span style="border-left: 10px solid springgreen"&gt;&nbsp;&lt;/span&gt;springgreen,
- &lt;span style="border-left: 10px solid turquoise"&gt;&nbsp;&lt;/span&gt;turquoise,
- &lt;span style="border-left: 10px solid powderblue"&gt;&nbsp;&lt;/span&gt;powderblue
</Admonition>


</LanguageContent>
<LanguageContent language="csharp">

<Admonition type="note" title="Note">

* When making a [Full-Text Search query](../../../../client-api/session/querying/text-search/full-text-search),  
  in addition to retrieving documents that contain the searched terms in the results,  
  you can also request to get a **list of text fragments that highlight the searched terms**.

* The highlighted terms can enhance user experience when searching for documents with specific content.

* This article shows highlighting search results when making a **dynamic-query**.  
  For highlighting search results when querying a **static-index** see [highlight index search results](../../../../indexes/querying/highlighting).
* In this page:
  * [Highlight - basic example](../../../../client-api/session/querying/text-search/highlight-query-results#highlight---basic-example)
      * [Highlight tags](../../../../client-api/session/querying/text-search/highlight-query-results#highlight-tags)
      * [Highlight results in Studio](../../../../client-api/session/querying/text-search/highlight-query-results#highlight-results-in-studio)
  * [Highlight - customize tags](../../../../client-api/session/querying/text-search/highlight-query-results#highlight---customize-tags)
  * [Highlight - projected results](../../../../client-api/session/querying/text-search/highlight-query-results#highlight---projected-results)
  * [Syntax](../../../../client-api/session/querying/text-search/highlight-query-results#syntax)
  
</Admonition>
## Highlight - basic example

<Tabs groupId='languageSyntax'>
<TabItem value="Query" label="Query">
<CodeBlock language="csharp">
{`// Make a full-text search dynamic query:
// ======================================
List<Employee> employeesResults = session
     // Make a dynamic query on 'Employees' collection
    .Query<Employee>()
     // Search for documents containing the term 'sales' in their 'Notes' field
    .Search(x => x.Notes, "sales")
     // Request to highlight the searched term by calling 'Highlight'
    .Highlight(
        x => x.Notes, // The document-field name in which we search
        35,           // Max length of each text fragment
        4,            // Max number of fragments to return per document
        out Highlightings salesHighlights) // An out param for getting the highlighted text fragments
     // Execute the query
    .ToList();
`}
</CodeBlock>
</TabItem>
<TabItem value="Query_async" label="Query_async">
<CodeBlock language="csharp">
{`// Make a full-text search dynamic query:
// ======================================
List<Employee> employeesResults = await asyncSession
     // Make a dynamic query on 'Employees' collection
    .Query<Employee>()
     // Search for documents containing the term 'sales' in their 'Notes' field
    .Search(x => x.Notes, "sales")
     // Request to highlight the searched term by calling 'Highlight'
    .Highlight(
        x => x.Notes, // The document-field name in which we search
        35,           // Max length of each text fragment
        4,            // Max number of fragments to return per document
        out Highlightings salesHighlights) // An out param for getting the highlighted text fragments
     // Execute the query
    .ToListAsync();
`}
</CodeBlock>
</TabItem>
<TabItem value="DocumentQuery" label="DocumentQuery">
<CodeBlock language="csharp">
{`// Make a full-text search dynamic DocumentQuery:
// ==============================================
List<Employee> employeesResults = session.Advanced
     // Make a dynamic documentQuery on 'Employees' collection
    .DocumentQuery<Employee>()
     // Search for documents containing the term 'sales' in their 'Notes' field
    .Search(x => x.Notes, "sales")
     // Request to highlight the searched term by calling 'Highlight'
    .Highlight(
        x => x.Notes, // The document-field name in which we search
        35,           // Max length of each text fragment
        4,            // Max number of fragments to return per document
        out Highlightings salesHighlights) // An out param for getting the highlighted text fragments
     // Execute the documentQuery
    .ToList();
`}
</CodeBlock>
</TabItem>
<TabItem value="RQL" label="RQL">
<CodeBlock language="sql">
{`from "Employees"
where search(Notes, "sales")
include highlight(Notes, 35, 4)
`}
</CodeBlock>
</TabItem>
</Tabs>

<TabItem value="something" label="fragments_1">
<CodeBlock language="csharp">
{`// Process results:
// ================

// 'employeesResults' contains all Employee DOCUMENTS that have 'sales' in their 'Notes' field.
// 'salesHighlights' contains the text FRAGMENTS that highlight the 'sales' term.

StringBuilder builder = new StringBuilder().AppendLine("<ul>");

foreach (var employee in employeesResults)
\{
    // Call 'GetFragments' to get all fragments for the specified employee Id
    string[] fragments = salesHighlights.GetFragments(employee.Id);
    foreach (var fragment in fragments)
    \{
        builder.AppendLine(
            $"<li>Doc: \{employee.Id\} Fragment: \{fragment\}</li>");
    \}
\}

string fragmentsHtml = builder.AppendLine("</ul>").ToString();

// The resulting fragmentsHtml:
// ============================

// <ul>
//   <li>Doc: employees/2-A Fragment: company as a <b style="background:yellow">sales</b></li>
//   <li>Doc: employees/2-A Fragment: promoted to <b style="background:yellow">sales</b> manager in</li>
//   <li>Doc: employees/2-A Fragment: president of <b style="background:yellow">sales</b> in March 1993</li>
//   <li>Doc: employees/2-A Fragment: member of the <b style="background:yellow">Sales</b> Management</li>
//   <li>Doc: employees/3-A Fragment: hired as a <b style="background:yellow">sales</b> associate in</li>
//   <li>Doc: employees/3-A Fragment: promoted to <b style="background:yellow">sales</b> representativ</li>
//   <li>Doc: employees/5-A Fragment: company as a <b style="background:yellow">sales</b> representativ</li>
//   <li>Doc: employees/5-A Fragment: promoted to <b style="background:yellow">sales</b> manager in</li>
//   <li>Doc: employees/5-A Fragment: <b style="background:yellow">Sales</b> Management." </li>
//   <li>Doc: employees/6-A Fragment: for the <b style="background:yellow">Sales</b> Professional.</li>
// </ul>
`}
</CodeBlock>
</TabItem>

<Admonition type="note" title="Note">

#### Highlight tags
* By default, the highlighted term is wrapped with the following html:  
  `<b style="background:yellow">term</b>`  

* When requesting to highlight multiple terms,  
  the background color returned for each different term will be in the following order:

  - &lt;span style="border-left: 10px solid yellow"&gt;&nbsp;&lt;/span&gt;yellow,
  - &lt;span style="border-left: 10px solid lawngreen"&gt;&nbsp;&lt;/span&gt;lawngreen,
  - &lt;span style="border-left: 10px solid aquamarine"&gt;&nbsp;&lt;/span&gt;aquamarine,
  - &lt;span style="border-left: 10px solid magenta"&gt;&nbsp;&lt;/span&gt;magenta,
  - &lt;span style="border-left: 10px solid palegreen"&gt;&nbsp;&lt;/span&gt;palegreen,
  - &lt;span style="border-left: 10px solid coral"&gt;&nbsp;&lt;/span&gt;coral,
  - &lt;span style="border-left: 10px solid wheat"&gt;&nbsp;&lt;/span&gt;wheat,
  - &lt;span style="border-left: 10px solid khaki"&gt;&nbsp;&lt;/span&gt;khaki,
  - &lt;span style="border-left: 10px solid lime"&gt;&nbsp;&lt;/span&gt;lime,
  - &lt;span style="border-left: 10px solid deepskyblue"&gt;&nbsp;&lt;/span&gt;deepskyblue,
  - &lt;span style="border-left: 10px solid deeppink"&gt;&nbsp;&lt;/span&gt;deeppink,
  - &lt;span style="border-left: 10px solid salmon"&gt;&nbsp;&lt;/span&gt;salmon,
  - &lt;span style="border-left: 10px solid peachpuff"&gt;&nbsp;&lt;/span&gt;peachpuff,
  - &lt;span style="border-left: 10px solid violet"&gt;&nbsp;&lt;/span&gt;violet,
  - &lt;span style="border-left: 10px solid mediumpurple"&gt;&nbsp;&lt;/span&gt;mediumpurple,
  - &lt;span style="border-left: 10px solid palegoldenrod"&gt;&nbsp;&lt;/span&gt;palegoldenrod,
  - &lt;span style="border-left: 10px solid darkkhaki"&gt;&nbsp;&lt;/span&gt;darkkhaki,
  - &lt;span style="border-left: 10px solid springgreen"&gt;&nbsp;&lt;/span&gt;springgreen,
  - &lt;span style="border-left: 10px solid turquoise"&gt;&nbsp;&lt;/span&gt;turquoise,
  - &lt;span style="border-left: 10px solid powderblue"&gt;&nbsp;&lt;/span&gt;powderblue

* The html tags that wrap the highlighted terms can be **customized** to any other tags.  
  See [customize tags](../../../../client-api/session/querying/text-search/highlight-query-results#highlight---customize-tags) below.

</Admonition>

<Admonition type="note" title="Note">

#### Highlight results in Studio
![Figure 1. Fragments results](./assets/fragmentsResults.png)

1. **Auto-Index**  
   This is the auto-index that was created by the server to serve the dynamic-query.  

2. **Results tab**  
   The results tab contains the resulting **documents** that match the provided RQL query.

3. **Highlight tab**  
   The highlight tab shows the resulting **fragments** that were included in the query result.

</Admonition>



## Highlight - customize tags

* The html tags that wrap the highlighted terms can be **customized** to any other tags.

<Tabs groupId='languageSyntax'>
<TabItem value="Query" label="Query">
<CodeBlock language="csharp">
{`// Define customized tags to use for highlighting the searched terms
// =================================================================
HighlightingOptions tagsToUse = new HighlightingOptions
{
    // Provide strings of your choice to 'PreTags' & 'PostTags', e.g.:
    // the first term searched for will be wrapped with '+++'
    // the second term searched for will be wrapped with '<<<' & '>>>'
    PreTags = new[] { "+++", "<<<" },
    PostTags = new[] { "+++", ">>>" }
};

// Make a full-text search dynamic query:
// ======================================
List<Employee> employeesResults = session
    .Query<Employee>()
     // Search for:
     //   * documents containing the term 'sales' in their 'Notes' field
     //   * OR for documents containing the term 'manager' in their 'Title' field
    .Search(x => x.Notes, "sales")
    .Search(x => x.Title, "manager")
     // Call 'Highlight' for each field searched
     // Pass 'tagsToUse' to OVERRIDE the default tags used 
    .Highlight(x => x.Notes, 35, 1, tagsToUse, out Highlightings salesHighlights)
    .Highlight(x => x.Title, 35, 1, tagsToUse, out Highlightings managerHighlights)
    .ToList();
`}
</CodeBlock>
</TabItem>
<TabItem value="Query_async" label="Query_async">
<CodeBlock language="csharp">
{`// Define customized tags to use for highlighting the searched terms
// =================================================================
HighlightingOptions tagsToUse = new HighlightingOptions
{
    // Provide strings of your choice to 'PreTags' & 'PostTags', e.g.:
    // The first term searched for will be wrapped with '+++'
    // the second term searched for will be wrapped with '<<<' & '>>>'
    PreTags = new[] { "+++", "<<<" },
    PostTags = new[] { "+++", ">>>" }
};

// Make a full-text search dynamic query:
// ======================================
List<Employee> employeesResults = await asyncSession
    .Query<Employee>()
     // Search for:
     //   * documents containing the term 'sales' in their 'Notes' field
     //   * OR for documents containing the term 'manager' in their 'Title' field
    .Search(x => x.Notes, "sales")
    .Search(x => x.Title, "manager")
     // Call 'Highlight' for each field searched
     // Pass 'tagsToUse' to OVERRIDE the default tags used 
    .Highlight(x => x.Notes, 35, 1, tagsToUse, out Highlightings salesHighlights)
    .Highlight(x => x.Title, 35, 1, tagsToUse, out Highlightings managerHighlights)
    .ToListAsync();
`}
</CodeBlock>
</TabItem>
<TabItem value="RQL" label="RQL">
<CodeBlock language="sql">
{`from "Employees"
where (search(Notes, "sales") or search(Title, "manager"))
include highlight(Notes, 35, 1, $p0), highlight(Title, 35, 1, $p1)
{
"p0":{"PreTags":["+++","<<<"],"PostTags":["+++",">>>"]},
"p1":{"PreTags":["+++","<<<"],"PostTags":["+++",">>>"]}
}
`}
</CodeBlock>
</TabItem>
</Tabs>

<TabItem value="something" label="fragments_2">
<CodeBlock language="csharp">
{`// The resulting salesHighlights fragments:
// ========================================

// "for the +++Sales+++ Professional."
// "hired as a +++sales+++ associate in"
// "company as a +++sales+++"
// "company as a +++sales+++ representativ"

// The resulting managerHighlights fragments:
// ==========================================

// "Sales <<<Manager>>>"
`}
</CodeBlock>
</TabItem>



## Highlight - projected results

* Highlighting can also be used when [projecting query results](../../../../client-api/session/querying/how-to-project-query-results).

<Tabs groupId='languageSyntax'>
<TabItem value="Query" label="Query">
<CodeBlock language="csharp">
{`// Make a full-text search dynamic query & project results:
// ========================================================
var employeesProjectedResults = session
    .Query<Employee>()
     // Search for documents containing 'sales' or 'german' in their 'Notes' field
    .Search(x => x.Notes, "manager german")
     // Request to highlight the searched terms from the 'Notes' field 
    .Highlight(x => x.Notes, 35, 2, out Highlightings termsHighlights)
     // Define the projection
    .Select(x => new
    {
        // These fields will be returned instead of the whole document
        // Note: it is Not mandatory to return the field in which we search for the highlights 
        Name = $"{x.FirstName} {x.LastName}",
        x.Title
    })
    .ToList();
`}
</CodeBlock>
</TabItem>
<TabItem value="Query_async" label="Query_async">
<CodeBlock language="csharp">
{`// Make a full-text search dynamic query & project results:
// ========================================================
var employeesProjectedResults = await asyncSession
    .Query<Employee>()
     // Search for documents containing 'sales' or 'german' in their 'Notes' field
    .Search(x => x.Notes, "manager german")
     // Request to highlight the searched terms from the 'Notes' field 
    .Highlight(x => x.Notes, 35, 2, out Highlightings termsHighlights)
     // Define the projection
    .Select(x => new
    {
        // These fields will be returned instead of the whole document
        // Note: it is Not mandatory to return the field in which we search for the highlights 
        Name = $"{x.FirstName} {x.LastName}",
        x.Title
    })
    .ToListAsync();
`}
</CodeBlock>
</TabItem>
<TabItem value="RQL" label="RQL">
<CodeBlock language="sql">
{`from "Employees" as x
where search(x.Notes, "manager german")
select { Name : "{0} {1}".format(x.FirstName, x.LastName), Title : x.Title }
include highlight(Notes, 35, 2)
`}
</CodeBlock>
</TabItem>
</Tabs>

<TabItem value="something" label="fragments_3">
<CodeBlock language="csharp">
{`// The resulting fragments from termsHighlights:
// =============================================

// "to sales <b style=\\"background:yellow\\">manager</b> in March"
// "and reads <b style=\\"background:lawngreen\\">German</b>.  He joined"
// "to sales <b style=\\"background:yellow\\">manager</b> in January"
// "in French and <b style=\\"background:lawngreen\\">German</b>."

// NOTE: each search term is wrapped with a different color
// 'manager' is wrapped with yellow
// 'german' is wrapped with lawngreen
`}
</CodeBlock>
</TabItem>



## Syntax

<TabItem value="something" label="syntax_1">
<CodeBlock language="csharp">
{`IRavenQueryable<T> Highlight(
    string fieldName,
    int fragmentLength,
    int fragmentCount,
    out Highlightings highlightings);

IRavenQueryable<T> Highlight(
    string fieldName,
    int fragmentLength,
    int fragmentCount,
    HighlightingOptions options,
    out Highlightings highlightings);

IRavenQueryable<T> Highlight(
    Expression<Func<T, object>> path,
    int fragmentLength,
    int fragmentCount,
    out Highlightings highlightings);

IRavenQueryable<T> Highlight(
    Expression<Func<T, object>> path,
    int fragmentLength,
    int fragmentCount,
    HighlightingOptions options,
    out Highlightings highlightings);
`}
</CodeBlock>
</TabItem>

| Parameter          | Type                          | Description                                                                               |
|--------------------|-------------------------------|-------------------------------------------------------------------------------------------|
| **fieldName**      | string                        | Name of the field that contains the searched terms to highlight.                          |
| **path**           | `Expression<Func<T, object>>` | Path to the field that contains the searched terms to highlight.                          |
| **fragmentLength** | int                           | Maximum length of a text fragment. Must be `>= 18`.                                       |
| **fragmentCount**  | int                           | Maximum number of text fragments that will be returned.                                   |
| **options**        | `HighlightingOptions`         | Customizing options.                                                                      |
| **highlightings**  | `Highlightings`               | An 'out' param that will contain the highlighted text fragments for each returned result. |

<br/>

**Highlighting options**:

<TabItem value="something" label="syntax_2">
<CodeBlock language="csharp">
{`public string GroupKey \{ get; set; \}
public string[] PreTags \{ get; set; \}
public string[] PostTags \{ get; set; \}
`}
</CodeBlock>
</TabItem>

| Option       | Type      | Description                                                                                                                                                                                                                                                                                                      |
|--------------|-----------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **GroupKey** | string    | Grouping key for the results.<br/>Used when highlighting query results from a [Map-Reduce index](../../../../indexes/querying/highlighting#highlight-results---map-reduce-index).<br/>If `null` results are grouped by document ID (default).<br/>Note: Highlighting is Not available for dynamic aggregation queries. |
| **PreTags**  | string[]  | Array of PRE tags used to wrap the highlighted search terms in the text fragments.                                                                                                                                                                                                                               |
| **PostTags** | string[]  | Array of POST tags used to wrap the highlighted search terms in the text fragments.                                                                                                                                                                                                                              |

<br/>

**Highlightings object**:

<TabItem value="something" label="syntax_3">
<CodeBlock language="csharp">
{`public string FieldName \{ get; \}
public IEnumerable<string> ResultIndents;
`}
</CodeBlock>
</TabItem>

| Property          | Type                 | Description                                                      |
|-------------------|----------------------|------------------------------------------------------------------|
| **FieldName**     | string               | Name of the field that contains the searched terms to highlight. |
| **ResultIndents** | `IEumerable<string>` | The resulting keys (document IDs, or the map-reduce keys).        |

<TabItem value="something" label="syntax_4">
<CodeBlock language="csharp">
{`public string[] GetFragments(string key);
`}
</CodeBlock>
</TabItem>

| Method           | Description                                                                                           |
|------------------|-------------------------------------------------------------------------------------------------------|
| **GetFragments** | Returns the list of the highlighted text fragments for the passed document ID, or the map-reduce key. |




</LanguageContent>
<LanguageContent language="python">

<Admonition type="note" title="Note">

* When making a [Full-Text Search query](../../../../client-api/session/querying/text-search/full-text-search),  
  in addition to retrieving documents that contain the searched terms in the results,  
  you can also request to get a **list of text fragments that highlight the searched terms**.

* The highlighted terms can enhance user experience when searching for documents with specific content.

* This article shows highlighting search results when making a **dynamic-query**.  
  For highlighting search results when querying a **static-index** see [highlight index search results](../../../../indexes/querying/highlighting).
* In this page:
  * [Highlight - basic example](../../../../client-api/session/querying/text-search/highlight-query-results#highlight---basic-example)
      * [Highlight tags](../../../../client-api/session/querying/text-search/highlight-query-results#highlight-tags)
      * [Highlight results in Studio](../../../../client-api/session/querying/text-search/highlight-query-results#highlight-results-in-studio)
  * [Highlight - customize tags](../../../../client-api/session/querying/text-search/highlight-query-results#highlight---customize-tags)
  * [Highlight - projected results](../../../../client-api/session/querying/text-search/highlight-query-results#highlight---projected-results)
  * [Syntax](../../../../client-api/session/querying/text-search/highlight-query-results#syntax)
  
</Admonition>
## Highlight - basic example

<Tabs groupId='languageSyntax'>
<TabItem value="Query" label="Query">
<CodeBlock language="python">
{`# Make a full-text search dynamic query:
# ======================================

# Define a callback that takes highlightings as an argument
sales_highlightings: Optional[Highlightings] = None

def _sales_highlights(highlightings: Highlightings):
    # You may use the results (highlightings) here in any way desired
    sales_highlightings = highlightings

employees_result = list(  # Execute the query inside the parenthesis
    session
    # Make a query on 'Employees' collection
    .query(object_type=Employee)
    # Search for documents containing the term 'sales' in their 'Notes' field
    .search("Notes", "sales")
    # Request to highlight the searched term by calling 'Highlight'
    .highlight(
        "Notes",  # The document-field name in which we search
        35,  # Max length of each text fragment
        4,  # Max number of fragments to return per document
        _sales_highlights,  # An out param for getting the highlighted text fragments
    )
)
`}
</CodeBlock>
</TabItem>
<TabItem value="RQL" label="RQL">
<CodeBlock language="sql">
{`from "Employees"
where search(Notes, "sales")
include highlight(Notes, 35, 4)
`}
</CodeBlock>
</TabItem>
</Tabs>

<TabItem value="something-something" label="fragments_1">
<CodeBlock language="python">
{`# Process results:
# ================

# 'employees_results' contains all Employee DOCUMENTS that have 'sales' in their 'Notes' field.
# 'sales_highlights' contains the text FRAGMENTS that highlight the 'sales' term.

builder = ["<ul>", \{os.linesep\}]
for employee in employees_result:
    # Call 'get_fragments' to get all fragments for the specified employee Id
    fragments = sales_highlightings.get_fragments(employee.Id)
    for fragment in fragments:
        builder.append(f"\{os.linesep\}<li>Doc: \{employee.Id\} Fragment: \{fragment\}</li>")

fragments_html = builder.append(f"\{os.linesep\}</ul>")

# The resulting fragments_html:
# ============================

# <ul>
#   <li>Doc: employees/2-A Fragment: company as a <b style="background:yellow">sales</b></li>
#   <li>Doc: employees/2-A Fragment: promoted to <b style="background:yellow">sales</b> manager in</li>
#   <li>Doc: employees/2-A Fragment: president of <b style="background:yellow">sales</b> in March 1993</li>
#   <li>Doc: employees/2-A Fragment: member of the <b style="background:yellow">Sales</b> Management</li>
#   <li>Doc: employees/3-A Fragment: hired as a <b style="background:yellow">sales</b> associate in</li>
#   <li>Doc: employees/3-A Fragment: promoted to <b style="background:yellow">sales</b> representativ</li>
#   <li>Doc: employees/5-A Fragment: company as a <b style="background:yellow">sales</b> representativ</li>
#   <li>Doc: employees/5-A Fragment: promoted to <b style="background:yellow">sales</b> manager in</li>
#   <li>Doc: employees/5-A Fragment: <b style="background:yellow">Sales</b> Management." </li>
#   <li>Doc: employees/6-A Fragment: for the <b style="background:yellow">Sales</b> Professional.</li>
#  </ul>
`}
</CodeBlock>
</TabItem>

<Admonition type="note" title="Note">

#### Highlight tags

* By default, the highlighted term is wrapped with the following html:  
  `<b style="background:yellow">term</b>`  

* When requesting to highlight multiple terms,  
  the background color returned for each different term will be in the following order:

  - &lt;span style="border-left: 10px solid yellow"&gt;&nbsp;&lt;/span&gt;yellow,
  - &lt;span style="border-left: 10px solid lawngreen"&gt;&nbsp;&lt;/span&gt;lawngreen,
  - &lt;span style="border-left: 10px solid aquamarine"&gt;&nbsp;&lt;/span&gt;aquamarine,
  - &lt;span style="border-left: 10px solid magenta"&gt;&nbsp;&lt;/span&gt;magenta,
  - &lt;span style="border-left: 10px solid palegreen"&gt;&nbsp;&lt;/span&gt;palegreen,
  - &lt;span style="border-left: 10px solid coral"&gt;&nbsp;&lt;/span&gt;coral,
  - &lt;span style="border-left: 10px solid wheat"&gt;&nbsp;&lt;/span&gt;wheat,
  - &lt;span style="border-left: 10px solid khaki"&gt;&nbsp;&lt;/span&gt;khaki,
  - &lt;span style="border-left: 10px solid lime"&gt;&nbsp;&lt;/span&gt;lime,
  - &lt;span style="border-left: 10px solid deepskyblue"&gt;&nbsp;&lt;/span&gt;deepskyblue,
  - &lt;span style="border-left: 10px solid deeppink"&gt;&nbsp;&lt;/span&gt;deeppink,
  - &lt;span style="border-left: 10px solid salmon"&gt;&nbsp;&lt;/span&gt;salmon,
  - &lt;span style="border-left: 10px solid peachpuff"&gt;&nbsp;&lt;/span&gt;peachpuff,
  - &lt;span style="border-left: 10px solid violet"&gt;&nbsp;&lt;/span&gt;violet,
  - &lt;span style="border-left: 10px solid mediumpurple"&gt;&nbsp;&lt;/span&gt;mediumpurple,
  - &lt;span style="border-left: 10px solid palegoldenrod"&gt;&nbsp;&lt;/span&gt;palegoldenrod,
  - &lt;span style="border-left: 10px solid darkkhaki"&gt;&nbsp;&lt;/span&gt;darkkhaki,
  - &lt;span style="border-left: 10px solid springgreen"&gt;&nbsp;&lt;/span&gt;springgreen,
  - &lt;span style="border-left: 10px solid turquoise"&gt;&nbsp;&lt;/span&gt;turquoise,
  - &lt;span style="border-left: 10px solid powderblue"&gt;&nbsp;&lt;/span&gt;powderblue

* The html tags that wrap the highlighted terms can be **customized** to any other tags.  
  See [customize tags](../../../../client-api/session/querying/text-search/highlight-query-results#highlight---customize-tags) below.

</Admonition>

<Admonition type="note" title="Note">

#### Highlight results in Studio

![Figure 1. Fragments results](./assets/fragmentsResults.png)

1. **Auto-Index**  
   This is the auto-index that was created by the server to serve the dynamic-query.  

2. **Results tab**  
   The results tab contains the resulting **documents** that match the provided RQL query.

3. **Highlight tab**  
   The highlight tab shows the resulting **fragments** that were included in the query result.

</Admonition>



## Highlight - customize tags

* The html tags that wrap the highlighted terms can be **customized** to any other tags.

<Tabs groupId='languageSyntax'>
<TabItem value="Query" label="Query">
<CodeBlock language="python">
{`# Define customized tags to use for highlighting the searched terms
# =================================================================
tags_to_use = HighlightingOptions(
    # Provide strings of your choice to 'PreTags' & 'PostTags', e.g.:
    # the first term searched for will be wrapped with '+++'
    # the second term searched for will be wrapped with '<<<' & '>>>'
    pre_tags=["+++", "<<<"],
    post_tags=["+++", ">>>"],
)

# Define a callback that takes highlightings as an argument
manager_highlightings: Optional[Highlightings] = None

def _manager_highlights(highlightings: Highlightings):
    # You may use the results (highlightings) here in any way desired
    manager_highlightings = highlightings

# Make a full-text search dynamic query:
# ======================================
employees_result = list(
    session.query(object_type=Employee)
    # Search for:
    #  * documents containing the term 'sales' in their 'Notes' field
    #  * OR for documents containing the term 'manager' in their 'Title' field
    .search("Notes", "sales")
    .search("Title", "manager")
    # Call 'Highlight' for each field searched
    # Pass 'tagsToUse' to OVERRIDE the default tags used
    .highlight("Notes", 35, 1, _sales_highlights)
    .highlight("Title", 35, 1, tags_to_use, _manager_highlights)
)
`}
</CodeBlock>
</TabItem>
<TabItem value="RQL" label="RQL">
<CodeBlock language="sql">
{`from "Employees"
where (search(Notes, "sales") or search(Title, "manager"))
include highlight(Notes, 35, 1, $p0), highlight(Title, 35, 1, $p1)
{
"p0":{"PreTags":["+++","<<<"],"PostTags":["+++",">>>"]},
"p1":{"PreTags":["+++","<<<"],"PostTags":["+++",">>>"]}
}
`}
</CodeBlock>
</TabItem>
</Tabs>

<TabItem value="something-something" label="fragments_2">
<CodeBlock language="python">
{`# The resulting salesHighlights fragments:
# ========================================
#
# "for the +++Sales+++ Professional."
# "hired as a +++sales+++ associate in"
# "company as a +++sales+++"
# "company as a +++sales+++ representative"
#
# The resulting managerHighlights fragments:
# ==========================================
#
# "Sales <<<Manager>>>"
`}
</CodeBlock>
</TabItem>



## Highlight - projected results

* Highlighting can also be used when [projecting query results](../../../../client-api/session/querying/how-to-project-query-results).

<Tabs groupId='languageSyntax'>
<TabItem value="Query" label="Query">
<CodeBlock language="python">
{`# Make a full-text search dynamic query & project results:
# ========================================================

# Define a callback that takes highlightings as an argument
terms_highlightings: Optional[Highlightings] = None

def _terms_highlights(highlightings: Highlightings):
    # You may use the results (highlightings) here in any way desired
    terms_highlightings = highlightings

employees_projected = list(
    session.query(object_type=Employee)
    .search("Notes", "manager german")
    .highlight("Notes", 35, 2, _terms_highlights)
    .select_fields_query_data(
        QueryData.custom_function("o", "{ Name: o.FirstName + ' ' + o.LastName, Title: o.Title }"),
    )
)

# todo reeb & gracjan: lets implement it after 5.4 release
#  i have a perfect ticket for that
#  https://issues.hibernatingrhinos.com/issue/RDBC-820#focus=Comments-67-1050834.0-0
`}
</CodeBlock>
</TabItem>
<TabItem value="RQL" label="RQL">
<CodeBlock language="sql">
{`from "Employees" as x
where search(x.Notes, "manager german")
select { Name : "{0} {1}".format(x.FirstName, x.LastName), Title : x.Title }
include highlight(Notes, 35, 2)
`}
</CodeBlock>
</TabItem>
</Tabs>

<TabItem value="something-something" label="fragments_3">
<CodeBlock language="python">
{`# The resulting fragments from termsHighlights:
# =============================================
#
# "to sales <b style=\\"background:yellow\\">manager</b> in March"
# "and reads <b style=\\"background:lawngreen\\">German</b>.  He joined"
# "to sales <b style=\\"background:yellow\\">manager</b> in January"
# "in French and <b style=\\"background:lawngreen\\">German</b>."
#
# NOTE: each search term is wrapped with a different color
# 'manager' is wrapped with yellow
# 'german' is wrapped with lawngreen
`}
</CodeBlock>
</TabItem>



## Syntax

<TabItem value="something-something" label="syntax_1">
<CodeBlock language="python">
{`def highlight(
    self,
    field_name: str,
    fragment_length: int,
    fragment_count: int,
    highlightings_callback: Callable[[Highlightings], None],
    options: Optional[HighlightingOptions] = None,
) -> DocumentQuery[_T]: ...
`}
</CodeBlock>
</TabItem>

| Parameter          | Type                          | Description                         |
|--------------------|-------------------------------|-------------------------------------|
| **field_name** | `str` | Name of the field that contains the searched terms to highlight |
| **fragment_length** | `int` | Maximum length of a text fragment<br/>Must be `>= 18` |
| **fragment_count** | `int` | Maximum number of text fragments that will be returned |
| **highlightings_callback** | `Callable[[Highlightings], None]` | A callback function to retrieve the highlighted text fragments for each returned result |
| **options** (Optional) | `HighlightingOptions ` | Customizing options |

<br/>

**Highlighting options**:

<TabItem value="something-something" label="syntax_2">
<CodeBlock language="python">
{`def __init__(self, group_key: str = None, pre_tags: List[str] = None, post_tags: List[str] = None):
    self.group_key = group_key
    self.pre_tags = pre_tags
    self.post_tags = post_tags
`}
</CodeBlock>
</TabItem>

| Option       | Type      | Description  |
|--------------|-----------|--------------|
| **group_key** | `str` | Grouping key for the results.<br/>Used when highlighting query results from a [Map-Reduce index](../../../../indexes/querying/highlighting#highlight-results---map-reduce-index).<br/>If `None` results are grouped by document ID (default).<br/>Note: Highlighting is Not available for dynamic aggregation queries. |
| **pre_tags** | `List[str]` | Array of PRE tags used to wrap the highlighted search terms in the text fragments. |
| **post_tags** | `List[str]` | Array of POST tags used to wrap the highlighted search terms in the text fragments. |

<br/>

**Highlightings object**:

<TabItem value="something-something" label="syntax_3">
<CodeBlock language="python">
{`def __init__(self, field_name: str):
    self.field_name = field_name
    ...

@property
def result_indents(self) -> Set[str]: ...
`}
</CodeBlock>
</TabItem>

| Property           | Type       | Description                                                     |
|--------------------|------------|-----------------------------------------------------------------|
| **field_name**     | `str`      | Name of the field that contains the searched terms to highlight |
| **result_indents** | `Set[str]` | The resulting keys (document IDs, or the map-reduce keys) |

<TabItem value="something-something" label="syntax_4">
<CodeBlock language="python">
{`def get_fragments(self, key: str) -> List[str]: ...
`}
</CodeBlock>
</TabItem>

| Method            | Return Type | Description    |
|-------------------|-------------|------------------------------------------------------------------------------------------------------|
| **get_fragments** | `List[str]` | Returns the list of the highlighted text fragments for the passed document ID, or the map-reduce key |




</LanguageContent>
<LanguageContent language="php">

<Admonition type="note" title="Note">

* When making a [Full-Text Search query](../../../../client-api/session/querying/text-search/full-text-search),  
  in addition to retrieving documents that contain the searched terms in the results,  
  you can also request to get a **list of text fragments that highlight the searched terms**.

* The highlighted terms can enhance user experience when searching for documents with specific content.

* This article shows highlighting search results when making a **dynamic-query**.  
  For highlighting search results when querying a **static-index** see [highlight index search results](../../../../indexes/querying/highlighting).
* In this page:
  * [Highlight - basic example](../../../../client-api/session/querying/text-search/highlight-query-results#highlight---basic-example)
      * [Highlight tags](../../../../client-api/session/querying/text-search/highlight-query-results#highlight-tags)
      * [Highlight results in Studio](../../../../client-api/session/querying/text-search/highlight-query-results#highlight-results-in-studio)
  * [Highlight - customize tags](../../../../client-api/session/querying/text-search/highlight-query-results#highlight---customize-tags)
  * [Highlight - projected results](../../../../client-api/session/querying/text-search/highlight-query-results#highlight---projected-results)
  * [Syntax](../../../../client-api/session/querying/text-search/highlight-query-results#syntax)
  
</Admonition>
## Highlight - basic example

<Tabs groupId='languageSyntax'>
<TabItem value="query" label="query">
<CodeBlock language="php">
{`// Make a full-text search dynamic query:
// ======================================

$highlightings = new Highlightings();

/** @var array<Employee> $employeesResults */
$employeesResults = $session
    // Make a dynamic query on 'Employees' collection
    ->query(Employee::class)
    // Search for documents containing the term 'sales' in their 'Notes' field
    ->search("Notes", "sales")
    // Request to highlight the searched term by calling 'highlight()'
    ->highlight(
        "Notes", // The document-field name in which we search
        35,           // Max length of each text fragment
        4,            // Max number of fragments to return per document
        null,           // Put null to use default options
        $highlightings) // An out param for getting the highlighted text fragments

    // Execute the query
    ->toList();
`}
</CodeBlock>
</TabItem>
<TabItem value="RQL" label="RQL">
<CodeBlock language="sql">
{`from "Employees"
where search(Notes, "sales")
include highlight(Notes, 35, 4)
`}
</CodeBlock>
</TabItem>
</Tabs>

<TabItem value="something-something" label="fragments_1">
<CodeBlock language="php">
{`// Process results:
// ================

// 'employeesResults' contains all Employee DOCUMENTS that have 'sales' in their 'Notes' field.
// 'salesHighlights' contains the text FRAGMENTS that highlight the 'sales' term.

$builder = '<ul>';

/** @var SearchItem $employee */
foreach ($employeesResults as $employee) \{
    // Call 'GetFragments' to get all fragments for the specified employee Id
    $fragments = $highlightings->getFragments($employee->getId());
    foreach ($fragments as $fragment) \{
        $builder .= '<li>Doc: ' . $employee->getId() . ' Fragment: ' . $fragment . '</li>';
    \}
\}

$builder .= '</ul>';
$fragmentsHtml = $builder;

// The resulting fragmentsHtml:
// ============================

// <ul>
//   <li>Doc: employees/2-A Fragment: company as a <b style="background:yellow">sales</b></li>
//   <li>Doc: employees/2-A Fragment: promoted to <b style="background:yellow">sales</b> manager in</li>
//   <li>Doc: employees/2-A Fragment: president of <b style="background:yellow">sales</b> in March 1993</li>
//   <li>Doc: employees/2-A Fragment: member of the <b style="background:yellow">Sales</b> Management</li>
//   <li>Doc: employees/3-A Fragment: hired as a <b style="background:yellow">sales</b> associate in</li>
//   <li>Doc: employees/3-A Fragment: promoted to <b style="background:yellow">sales</b> representativ</li>
//   <li>Doc: employees/5-A Fragment: company as a <b style="background:yellow">sales</b> representativ</li>
//   <li>Doc: employees/5-A Fragment: promoted to <b style="background:yellow">sales</b> manager in</li>
//   <li>Doc: employees/5-A Fragment: <b style="background:yellow">Sales</b> Management." </li>
//   <li>Doc: employees/6-A Fragment: for the <b style="background:yellow">Sales</b> Professional.</li>
// </ul>
`}
</CodeBlock>
</TabItem>

<Admonition type="note" title="Note">

#### Highlight tags

* By default, the highlighted term is wrapped with the following html:  
  `<b style="background:yellow">term</b>`  

* When requesting to highlight multiple terms,  
  the background color returned for each different term will be in the following order:

  - &lt;span style="border-left: 10px solid yellow"&gt;&nbsp;&lt;/span&gt;yellow,
  - &lt;span style="border-left: 10px solid lawngreen"&gt;&nbsp;&lt;/span&gt;lawngreen,
  - &lt;span style="border-left: 10px solid aquamarine"&gt;&nbsp;&lt;/span&gt;aquamarine,
  - &lt;span style="border-left: 10px solid magenta"&gt;&nbsp;&lt;/span&gt;magenta,
  - &lt;span style="border-left: 10px solid palegreen"&gt;&nbsp;&lt;/span&gt;palegreen,
  - &lt;span style="border-left: 10px solid coral"&gt;&nbsp;&lt;/span&gt;coral,
  - &lt;span style="border-left: 10px solid wheat"&gt;&nbsp;&lt;/span&gt;wheat,
  - &lt;span style="border-left: 10px solid khaki"&gt;&nbsp;&lt;/span&gt;khaki,
  - &lt;span style="border-left: 10px solid lime"&gt;&nbsp;&lt;/span&gt;lime,
  - &lt;span style="border-left: 10px solid deepskyblue"&gt;&nbsp;&lt;/span&gt;deepskyblue,
  - &lt;span style="border-left: 10px solid deeppink"&gt;&nbsp;&lt;/span&gt;deeppink,
  - &lt;span style="border-left: 10px solid salmon"&gt;&nbsp;&lt;/span&gt;salmon,
  - &lt;span style="border-left: 10px solid peachpuff"&gt;&nbsp;&lt;/span&gt;peachpuff,
  - &lt;span style="border-left: 10px solid violet"&gt;&nbsp;&lt;/span&gt;violet,
  - &lt;span style="border-left: 10px solid mediumpurple"&gt;&nbsp;&lt;/span&gt;mediumpurple,
  - &lt;span style="border-left: 10px solid palegoldenrod"&gt;&nbsp;&lt;/span&gt;palegoldenrod,
  - &lt;span style="border-left: 10px solid darkkhaki"&gt;&nbsp;&lt;/span&gt;darkkhaki,
  - &lt;span style="border-left: 10px solid springgreen"&gt;&nbsp;&lt;/span&gt;springgreen,
  - &lt;span style="border-left: 10px solid turquoise"&gt;&nbsp;&lt;/span&gt;turquoise,
  - &lt;span style="border-left: 10px solid powderblue"&gt;&nbsp;&lt;/span&gt;powderblue

* The html tags that wrap the highlighted terms can be **customized** to any other tags.  
  See [customize tags](../../../../client-api/session/querying/text-search/highlight-query-results#highlight---customize-tags) below.

</Admonition>

<Admonition type="note" title="Note">

#### Highlight results in Studio

![Figure 1. Fragments results](./assets/fragmentsResults.png)

1. **Auto-Index**  
   This is the auto-index that was created by the server to serve the dynamic-query.  

2. **Results tab**  
   The results tab contains the resulting **documents** that match the provided RQL query.

3. **Highlight tab**  
   The highlight tab shows the resulting **fragments** that were included in the query result.

</Admonition>



## Highlight - customize tags

* The html tags that wrap the highlighted terms can be **customized** to any other tags.

<Tabs groupId='languageSyntax'>
<TabItem value="query" label="query">
<CodeBlock language="php">
{`// Define customized tags to use for highlighting the searched terms
// =================================================================

$salesHighlights = new Highlightings();
$managerHighlights = new Highlightings();

$tagsToUse = new HighlightingOptions();
// Provide strings of your choice to 'PreTags' & 'PostTags', e.g.:
// the first term searched for will be wrapped with '+++'
// the second term searched for will be wrapped with '<<<' & '>>>'
$tagsToUse->setPreTags(["+++", "<<<"]);
$tagsToUse->setPostTags(["+++", ">>>"]);

// Make a full-text search dynamic query:
// ======================================
$employeesResults = $session
    ->query(Employee::class)
    // Search for:
    //   * documents containing the term 'sales' in their 'Notes' field
    //   * OR for documents containing the term 'manager' in their 'Title' field
    ->search("Notes", "sales")
    ->search("Title", "manager")
    // Call 'Highlight' for each field searched
    // Pass 'tagsToUse' to OVERRIDE the default tags used
    ->highlight("Notes", 35, 1, $tagsToUse, $salesHighlights)
    ->highlight("Title", 35, 1, $tagsToUse, $managerHighlights)
    ->toList();
`}
</CodeBlock>
</TabItem>
<TabItem value="RQL" label="RQL">
<CodeBlock language="sql">
{`from "Employees"
where (search(Notes, "sales") or search(Title, "manager"))
include highlight(Notes, 35, 1, $p0), highlight(Title, 35, 1, $p1)
{
"p0":{"PreTags":["+++","<<<"],"PostTags":["+++",">>>"]},
"p1":{"PreTags":["+++","<<<"],"PostTags":["+++",">>>"]}
}
`}
</CodeBlock>
</TabItem>
</Tabs>

<TabItem value="something-something" label="fragments_2">
<CodeBlock language="php">
{`// The resulting salesHighlights fragments:
// ========================================

// "for the +++Sales+++ Professional."
// "hired as a +++sales+++ associate in"
// "company as a +++sales+++"
// "company as a +++sales+++ representativ"

// The resulting managerHighlights fragments:
// ==========================================

// "Sales <<<Manager>>>"
`}
</CodeBlock>
</TabItem>



## Highlight - projected results

* Highlighting can also be used when [projecting query results](../../../../client-api/session/querying/how-to-project-query-results).

<Tabs groupId='languageSyntax'>
<TabItem value="query" label="query">
<CodeBlock language="php">
{`// Make a full-text search dynamic query & project results:
// ========================================================
$termsHighlights = new Highlightings();

/** @var array<Employee> $employeesProjectedResults */
$employeesProjectedResults = $session
    ->query(Employee::class)
    // Search for documents containing 'sales' or 'german' in their 'Notes' field
    ->search("Notes", "manager german")
    // Request to highlight the searched terms from the 'Notes' field
    ->highlight("Notes", 35, 2, null, $termsHighlights)
    // Define the projection
    ->selectFields(EmployeeDetails::class, QueryData::customFunction("o", "{ name: o.FirstName + ' ' + o.LastName, title: o.Title }"))
    ->toList();
`}
</CodeBlock>
</TabItem>
<TabItem value="RQL" label="RQL">
<CodeBlock language="sql">
{`from "Employees" as x
where search(x.Notes, "manager german")
select { Name : "{0} {1}".format(x.FirstName, x.LastName), Title : x.Title }
include highlight(Notes, 35, 2)
`}
</CodeBlock>
</TabItem>
</Tabs>

<TabItem value="something-something" label="fragments_3">
<CodeBlock language="php">
{`// The resulting fragments from termsHighlights:
// =============================================

// "to sales <b style=\\"background:yellow\\">manager</b> in March"
// "and reads <b style=\\"background:lawngreen\\">German</b>.  He joined"
// "to sales <b style=\\"background:yellow\\">manager</b> in January"
// "in French and <b style=\\"background:lawngreen\\">German</b>."

// NOTE: each search term is wrapped with a different color
// 'manager' is wrapped with yellow
// 'german' is wrapped with lawngreen
`}
</CodeBlock>
</TabItem>



## Syntax

<TabItem value="something-something" label="syntax_1">
<CodeBlock language="php">
{`function highlight(
    ?string              $fieldName,
    int                  $fragmentLength,
    int                  $fragmentCount,
    ?HighlightingOptions $options,
    Highlightings        &$highlightings
): DocumentQueryInterface;
`}
</CodeBlock>
</TabItem>

| Parameter          | Type                          | Description                         |
|--------------------|-------------------------------|-------------------------------------|
| **$fieldName** | `?string` | Name of the field that contains the searched terms to highlight |
| **$fragmentLength** | `int` | Maximum length of a text fragment<br/>Must be `>= 18` |
| **$fragmentCount** | `int` | Maximum number of text fragments that will be returned |
| **$options** | `?HighlightingOptions ` | Customizing options |
| **&$highlightings** | `Highlightings` | A callback function to retrieve the highlighted text fragments for each returned result |

<br/>

**Highlighting options**:

<TabItem value="something-something" label="syntax_2">
<CodeBlock language="php">
{`private ?string $groupKey;
private ?StringArray $preTags = null;
private ?StringArray $postTags = null;

// getters and setters
`}
</CodeBlock>
</TabItem>

| Option       | Type      | Description  |
|--------------|-----------|--------------|
| **$groupKey** | `?string` | Grouping key for the results.<br/>Used when highlighting query results from a [Map-Reduce index](../../../../indexes/querying/highlighting#highlight-results---map-reduce-index).<br/>If `None` results are grouped by document ID (default).<br/>Note: Highlighting is Not available for dynamic aggregation queries. |
| **$preTags** | `?StringArray` | Array of PRE tags used to wrap the highlighted search terms in the text fragments. |
| **$postTags** | `?StringArray` | Array of POST tags used to wrap the highlighted search terms in the text fragments. |

<br/>

**Highlightings object**:

<TabItem value="something-something" label="syntax_3">
<CodeBlock language="php">
{`private ?string $fieldName = null;
public function getResultIndents(): array;
`}
</CodeBlock>
</TabItem>

| Property           | Type       | Description |
|--------------------|------------|-------------|
| **$fieldName**     | `?string`      | Name of the field that contains the searched terms to highlight |
| **getResultIndents()** | function returning an `array` | The resulting keys (document IDs, or the map-reduce keys) |

<TabItem value="something-something" label="syntax_4">
<CodeBlock language="php">
{`public function getFragments(?string $key): array;
`}
</CodeBlock>
</TabItem>

| Method            | Return Type | Description |
|-------------------|-------------|-------------|
| **getFragments(?string $key)** | function returning an `array` | Returns the list of the highlighted text fragments for the passed document ID, or the map-reduce key |




</LanguageContent>
<LanguageContent language="nodejs">

<Admonition type="note" title="Note">

* When making a [Full-Text Search query](../../../../client-api/session/querying/text-search/full-text-search),  
  in addition to retrieving documents that contain the searched terms in the results,  
  you can also request to get a __list of text fragments that highlight the searched terms__.

* The highlighted terms can enhance user experience when searching for documents with specific content.

* This article shows highlighting search results when making a __dynamic-query__.  
  For highlighting search results when querying a __static-index__ see [highlight index search results](../../../../indexes/querying/highlighting).
* In this page:
  * [Highlight - basic example](../../../../client-api/session/querying/text-search/highlight-query-results#highlight---basic-example)
      * [Highlight tags](../../../../client-api/session/querying/text-search/highlight-query-results#highlight-tags)
      * [Highlight results in Studio](../../../../client-api/session/querying/text-search/highlight-query-results#highlight-results-in-studio)
  * [Highlight - customize tags](../../../../client-api/session/querying/text-search/highlight-query-results#highlight---customize-tags)
  * [Highlight - projected results](../../../../client-api/session/querying/text-search/highlight-query-results#highlight---projected-results)
  * [Syntax](../../../../client-api/session/querying/text-search/highlight-query-results#syntax)
  
</Admonition>
## Highlight - basic example

<Tabs groupId='languageSyntax'>
<TabItem value="Query" label="Query">
<CodeBlock language="nodejs">
{`// Make a full-text search dynamic query:
// ======================================

// Define a param that will get the highlighted text fragments
let salesHighlights;

const employeesResults = await session
     // Make a dynamic query on 'Employees' collection
    .query({ collection: "Employees" })
     // Search for documents containing the term 'sales' in their 'Notes' field
    .search("Notes", "sales")
     // Request to highlight the searched term by calling 'highlight'
    .highlight({ 
        fieldName: 'Notes', // The document-field name in which we search 
        fragmentLength: 35, // Max length of each text fragment
        fragmentCount: 4 }, // Max number of fragments to return per document
        x => { salesHighlights = x; }) // Output param 'salesHighlights' will be filled
                                       // with the highlighted text fragments when query returns. 
     // Execute the query
    .all();
`}
</CodeBlock>
</TabItem>
<TabItem value="RQL" label="RQL">
<CodeBlock language="sql">
{`from "Employees"
where search(Notes, "sales")
include highlight(Notes, 35, 4)
`}
</CodeBlock>
</TabItem>
</Tabs>

<TabItem value="something-something" label="fragments_1">
<CodeBlock language="nodejs">
{`// Process results:
// ================

// 'employeesResults' contains all Employee DOCUMENTS that have 'sales' in their 'Notes' field.
// 'salesHighlights' contains the text FRAGMENTS that highlight the 'sales' term.

let fragmentsHtml = "<ul>";

employeesResults.forEach((employee) => \{
    // Call 'getFragments' to get all fragments for the specified employee id
    let fragments = salesHighlights.getFragments(employee.id);
    
    fragments.forEach((fragment) => \{
        fragmentsHtml += \`<li>Doc: $\{employee.id\} Fragment: $\{fragment\}</li>\`;
    \});
\});

fragmentsHtml += "</ul>";

// The resulting fragmentsHtml:
// ============================

// <ul>
//   <li>Doc: employees/2-A Fragment: company as a <b style="background:yellow">sales</b></li>
//   <li>Doc: employees/2-A Fragment: promoted to <b style="background:yellow">sales</b> manager in</li>
//   <li>Doc: employees/2-A Fragment: president of <b style="background:yellow">sales</b> in March 1993</li>
//   <li>Doc: employees/2-A Fragment: member of the <b style="background:yellow">Sales</b> Management</li>
//   <li>Doc: employees/3-A Fragment: hired as a <b style="background:yellow">sales</b> associate in</li>
//   <li>Doc: employees/3-A Fragment: promoted to <b style="background:yellow">sales</b> representativ</li>
//   <li>Doc: employees/5-A Fragment: company as a <b style="background:yellow">sales</b> representativ</li>
//   <li>Doc: employees/5-A Fragment: promoted to <b style="background:yellow">sales</b> manager in</li>
//   <li>Doc: employees/5-A Fragment: <b style="background:yellow">Sales</b> Management." </li>
//   <li>Doc: employees/6-A Fragment: for the <b style="background:yellow">Sales</b> Professional.</li>
// </ul>
`}
</CodeBlock>
</TabItem>

<Admonition type="note" title="Note">

#### Highlight tags
* By default, the highlighted term is wrapped with the following html:  
  `<b style="background:yellow">term</b>`  

* When requesting to highlight multiple terms,  
  the background color returned for each different term will be in the following order:

  - &lt;span style="border-left: 10px solid yellow"&gt;&nbsp;&lt;/span&gt;yellow,
  - &lt;span style="border-left: 10px solid lawngreen"&gt;&nbsp;&lt;/span&gt;lawngreen,
  - &lt;span style="border-left: 10px solid aquamarine"&gt;&nbsp;&lt;/span&gt;aquamarine,
  - &lt;span style="border-left: 10px solid magenta"&gt;&nbsp;&lt;/span&gt;magenta,
  - &lt;span style="border-left: 10px solid palegreen"&gt;&nbsp;&lt;/span&gt;palegreen,
  - &lt;span style="border-left: 10px solid coral"&gt;&nbsp;&lt;/span&gt;coral,
  - &lt;span style="border-left: 10px solid wheat"&gt;&nbsp;&lt;/span&gt;wheat,
  - &lt;span style="border-left: 10px solid khaki"&gt;&nbsp;&lt;/span&gt;khaki,
  - &lt;span style="border-left: 10px solid lime"&gt;&nbsp;&lt;/span&gt;lime,
  - &lt;span style="border-left: 10px solid deepskyblue"&gt;&nbsp;&lt;/span&gt;deepskyblue,
  - &lt;span style="border-left: 10px solid deeppink"&gt;&nbsp;&lt;/span&gt;deeppink,
  - &lt;span style="border-left: 10px solid salmon"&gt;&nbsp;&lt;/span&gt;salmon,
  - &lt;span style="border-left: 10px solid peachpuff"&gt;&nbsp;&lt;/span&gt;peachpuff,
  - &lt;span style="border-left: 10px solid violet"&gt;&nbsp;&lt;/span&gt;violet,
  - &lt;span style="border-left: 10px solid mediumpurple"&gt;&nbsp;&lt;/span&gt;mediumpurple,
  - &lt;span style="border-left: 10px solid palegoldenrod"&gt;&nbsp;&lt;/span&gt;palegoldenrod,
  - &lt;span style="border-left: 10px solid darkkhaki"&gt;&nbsp;&lt;/span&gt;darkkhaki,
  - &lt;span style="border-left: 10px solid springgreen"&gt;&nbsp;&lt;/span&gt;springgreen,
  - &lt;span style="border-left: 10px solid turquoise"&gt;&nbsp;&lt;/span&gt;turquoise,
  - &lt;span style="border-left: 10px solid powderblue"&gt;&nbsp;&lt;/span&gt;powderblue

* The html tags that wrap the highlighted terms can be __customized__ to any other tags.  
  See [customize tags](../../../../client-api/session/querying/text-search/highlight-query-results#highlight---customize-tags) below.

</Admonition>

<Admonition type="note" title="Note">

#### Highlight results in Studio
![Figure 1. Fragments results](./assets/fragmentsResults.png)

1. __Auto-Index__  
   This is the auto-index that was created by the server to serve the dynamic-query.

2. __Results tab__  
   The results tab contains the resulting __documents__ that match the provided RQL query.

3. __Highlight tab__  
   The highlight tab shows the resulting __fragments__ that were included in the query result.

</Admonition>



## Highlight - customize tags

* The html tags that wrap the highlighted terms can be __customized__ to any other tags.

<Tabs groupId='languageSyntax'>
<TabItem value="Query" label="Query">
<CodeBlock language="nodejs">
{`// Define customized tags to use for highlighting the searched terms
// =================================================================
const tagsToUse = {
    preTags: ["+++", "<<<"],
    postTags: ["+++", ">>>"]
};

// Make a full-text search dynamic query:
// ======================================
let salesHighlights;
let managerHighlights;

const employeesResults = await session
    .query({ collection: "Employees" })
     // Search for:
     //   * documents containing the term 'sales' in their 'Notes' field
     //   * OR for documents containing the term 'manager' in their 'Title' field
    .search("Notes", "sales")
    .search("Title", "manager")
     // Call 'highlight' for each field searched
     // Pass 'tagsToUse' to OVERRIDE the default tags used 
    .highlight({ fieldName: 'Notes', fragmentLength: 35, fragmentCount: 1, ...tagsToUse },
            x => { salesHighlights = x; })
    .highlight({ fieldName: 'Title', fragmentLength: 35, fragmentCount: 1, ...tagsToUse },
            x => { managerHighlights = x; })
    .all();
`}
</CodeBlock>
</TabItem>
<TabItem value="RQL" label="RQL">
<CodeBlock language="sql">
{`from "Employees"
where (search(Notes, "sales") or search(Title, "manager"))
include highlight(Notes, 35, 1, $p0), highlight(Title, 35, 1, $p1)
{
"p0":{"PreTags":["+++","<<<"],"PostTags":["+++",">>>"]},
"p1":{"PreTags":["+++","<<<"],"PostTags":["+++",">>>"]}
}
`}
</CodeBlock>
</TabItem>
</Tabs>

<TabItem value="something-something" label="fragments_2">
<CodeBlock language="nodejs">
{`// The resulting salesHighlights fragments:
// ========================================

// "for the +++Sales+++ Professional."
// "hired as a +++sales+++ associate in"
// "company as a +++sales+++"
// "company as a +++sales+++ representativ"

// The resulting managerHighlights fragments:
// ==========================================

// "Sales <<<Manager>>>"        
`}
</CodeBlock>
</TabItem>



## Highlight - projected results

* Highlighting can also be used when [projecting query results](../../../../client-api/session/querying/how-to-project-query-results).

<Tabs groupId='languageSyntax'>
<TabItem value="Query" label="Query">
<CodeBlock language="nodejs">
{`// Make a full-text search dynamic query & project results:
// ========================================================

// Define a param that will get the highlighted text fragments
let termsHighlights;

// Define the class for the projected results
class Result {
    constructor () {
        this.Name = null;
        this.Title = null;
    }
}

// Make a dynamic query on 'Employees' collection
const employeesResults = await session
    .query({ collection: "Employees" })
     // Search for documents containing 'sales' or 'german' in their 'Notes' field
    .search("Notes", "manager german")
     // Request to highlight the searched terms from the 'Notes' field 
    .highlight({ fieldName: "Notes", fragmentLength: 35, fragmentCount: 2 },
            x => { termsHighlights = x; })
     // Define the projection
    .selectFields(QueryData.customFunction("o", "{ Name: o.FirstName + ' ' + o.LastName, Title: o.Title }" ),
        Result)
    .all();
`}
</CodeBlock>
</TabItem>
<TabItem value="RQL" label="RQL">
<CodeBlock language="sql">
{`from "Employees" as x
where search(x.Notes, "manager german")
select { Name : "{0} {1}".format(x.FirstName, x.LastName), Title : x.Title }
include highlight(Notes, 35, 2)
`}
</CodeBlock>
</TabItem>
</Tabs>

<TabItem value="something-something" label="fragments_3">
<CodeBlock language="nodejs">
{`// The resulting fragments from termsHighlights:
// =============================================

// "to sales <b style=\\"background:yellow\\">manager</b> in March"
// "and reads <b style=\\"background:lawngreen\\">German</b>.  He joined"
// "to sales <b style=\\"background:yellow\\">manager</b> in January"
// "in French and <b style=\\"background:lawngreen\\">German</b>."

// NOTE: each search term is wrapped with a different color
// 'manager' is wrapped with yellow
// 'german' is wrapped with lawngreen
`}
</CodeBlock>
</TabItem>



## Syntax

<TabItem value="something-something" label="syntax_1">
<CodeBlock language="nodejs">
{`highlight(parameters, hightlightingsCallback);
`}
</CodeBlock>
</TabItem>

| Parameter                  | Type                          | Description                                                                                                                                                  |
|----------------------------|-------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------|
| __parameters__             | `HighlightingParameters`      | Parameters for the highlight method.                                                                                                                         |
| __hightlightingsCallback__ | `(highlightResults) => void)` | A callback function with an output parameter.<br/>The parameter passed to the callback will be filled with the `Highlightings` object when query returns. |

<br/>

__The Highlighting parameters:__

| Parameter          | Type            | Description                                                                                                                                                                                                                                                                                                          |
|--------------------|-----------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| __fieldName__      | string          | Name of the field that contains the searched terms to highlight.                                                                                                                                                                                                                                                     |
| __fragmentLength__ | number          | Maximum length of a text fragment. Must be `>= 18`.                                                                                                                                                                                                                                                                  |
| __fragmentCount__  | number          | Maximum number of text fragments that will be returned.                                                                                                                                                                                                                                                              |
| __groupKey__       | string          | Grouping key for the results.<br/>Used when highlighting query results from a [Map-Reduce index](../../../../indexes/querying/highlighting#highlight-results---map-reduce-index).<br/>If `null` results are grouped by document ID (default).<br/>Note: Highlighting is Not available for dynamic aggregation queries. |
| __preTags__        | string[]        | Array of PRE tags used to wrap the highlighted search terms in the text fragments.                                                                                                                                                                                                                                   |
| __postTags__       | string[]        | Array of POST tags used to wrap the highlighted search terms in the text fragments.                                                                                                                                                                                                                                  |

<br/>

__The Highlightings object__:

<TabItem value="something-something" label="syntax_2">
<CodeBlock language="nodejs">
{`class Highlightings \{
    // Name of the field that contains the searched terms to highlight.
    get fieldName();
    // The resulting keys (document IDs, or the map-reduce keys)
    get resultIndents();
    // Returns the list of the highlighted text fragments for the passed document ID, or the map-reduce key
    getFragments(key);
\}
`}
</CodeBlock>
</TabItem>




</LanguageContent>