---
title: "Compare Exchange Metadata"
sidebar_label: Compare Exchange Metadata
sidebar_position: 7
hide_table_of_contents: true
---

import Admonition from '@theme/Admonition';
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import CodeBlock from '@theme/CodeBlock';
import LanguageSwitcher from "@site/src/components/LanguageSwitcher";
import LanguageContent from "@site/src/components/LanguageContent";

export const supportedLanguages = ["csharp"];


# Compare Exchange Metadata
<LanguageSwitcher supportedLanguages={supportedLanguages} />
<LanguageContent language="csharp">

<Admonition type="note" title="Note">

* RavenDB 5.0 added metadata to compare exchange values.  

* In this page:  
  * [Syntax](../../../client-api/operations/compare-exchange/compare-exchange-metadata#syntax)

</Admonition>
## Syntax

A compare exchange value's metadata is very similar to a 
[document's metadata](../../../client-api/session/how-to/get-and-modify-entity-metadata).  

The metadata can be used to set [compare exchange expiration](../../../client-api/operations/compare-exchange/compare-exchange-expiration).  

The metadata is accessible as a root property of the compare exchange value object:  

<TabItem value="something-something" label="metadata_0">
<CodeBlock language="csharp">
{`using (IAsyncDocumentSession session = store.OpenAsyncSession(
                                       new SessionOptions \{ 
                                           TransactionMode = TransactionMode.ClusterWide 
                                       \}))
\{
    // Create a new compare exchange value
    var cmpxchgValue = session.Advanced.ClusterTransaction.CreateCompareExchangeValue("key", "value");

    // Add a field to the metadata
    // with a value of type string
    cmpxchgValue.Metadata["Field name"] = "some value";

    // Retrieve metadata as a dictionary
    IDictionary<string, object> cmpxchgMetadata = cmpxchgValue.Metadata;
\}
`}
</CodeBlock>
</TabItem>

You can send it as a parameter of the 
[Put Compare Exchange Value operation](../../../client-api/operations/compare-exchange/put-compare-exchange-value):  

<TabItem value="something-something" label="metadata_1">
<CodeBlock language="csharp">
{`// Create some metadata
var cmpxchgMetadata = new MetadataAsDictionary \{
                          ["Year"] = "2020" 
                      \};

// Create/update the compare exchange value "best"
await documentStore.Operations.SendAsync(
    new PutCompareExchangeValueOperation<User>(
        "best", 
        new User \{ Name = "Alice" \}, 
        0, 
        cmpxchgMetadata));
`}
</CodeBlock>
</TabItem>





</LanguageContent>

<!---
### Client API
- [Session: How to Get and Modify Entity Metadata](../../../client-api/session/how-to/get-and-modify-entity-metadata)
- [Compare Exchange: Overview](../../../client-api/operations/compare-exchange/overview)
- [Compare Exchange Expiration](../../../client-api/operations/compare-exchange/compare-exchange-expiration)

### Server
- [Document Expiration](../../../server/extensions/expiration)


-->