---
title: "Migration: Client Breaking Changes"
sidebar_label: Client Breaking Changes
sidebar_position: 0
hide_table_of_contents: true
---

import Admonition from '@theme/Admonition';
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import CodeBlock from '@theme/CodeBlock';
import LanguageSwitcher from "@site/src/components/LanguageSwitcher";
import LanguageContent from "@site/src/components/LanguageContent";

# Migration: Client Breaking Changes
<Admonition type="note" title="Note">
The features listed on this page were available in former RavenDB versions.  
In RavenDB `7.0`, they are either unavailable or their behavior is inconsistent 
with their behavior in previous versions.  

* In this page:
   * [Subscription creation overload modification](../../migration/client-api/client-breaking-changes.mdx#subscription-creation-overload-modification)  
   * [HTTP-Compression algorithm is now `Zstd` by default](../../migration/client-api/client-breaking-changes.mdx#http-compression-algorithm-is-now-zstd-by-default)  
   * [Bulk-insert Compression is now Enabled by default](../../migration/client-api/client-breaking-changes.mdx#bulk-insert-compression-is-now-enabled-by-default)  
   * [Removed irrelevant `SingleNodeBatchCommand` parameters](../../migration/client-api/client-breaking-changes.mdx#removed-irrelevant-singlenodebatchcommand-parameters)  
   * [Removed obsolete methods](../../migration/client-api/client-breaking-changes.mdx#removed-obsolete-methods)  
   * [`FromEtl` is now internal](../../migration/client-api/client-breaking-changes.mdx#frometl-is-now-internal)  

</Admonition>
## Subscription creation overload modification

* In RavenDB versions earlier than **7.0**, the `Create<T>` method overload that accepted a predicate also allowed specifying a query through `SubscriptionCreationOptions`, 
  which could cause errors and confusion.
* To eliminate this ambiguity, starting from **7.0**, the `Create<T>` overload for predicate-based subscriptions now accepts `PredicateSubscriptionCreationOptions`,
  which no longer includes a `Query` property.
* Refer to the [Subscription creation API overview](../../client-api/data-subscriptions/creation/api-overview.mdx) for the complete list of available `Create` method overloads.

<Tabs groupId='languageSyntax'>
<TabItem value="7.0_and_on" label="7.0_and_on">
<CodeBlock language="csharp">
{`// The create overload using a predicate:
// ======================================
string Create<T>(Expression<Func<T, bool>> predicate = null,
    PredicateSubscriptionCreationOptions options = null,
    string database = null);

Task<string> CreateAsync<T>(Expression<Func<T, bool>> predicate = null,
    PredicateSubscriptionCreationOptions options = null,
    string database = null,
    CancellationToken token = default);

// The options class:
// ==================
public sealed class PredicateSubscriptionCreationOptions
{
    public string Name { get; set; }
    public string ChangeVector { get; set; }
    public string MentorNode { get; set; }
    public bool Disabled { get; set; }
    public bool PinToMentorNode { get; set; }
    public ArchivedDataProcessingBehavior? ArchivedDataProcessingBehavior { get; set; }
}
`}
</CodeBlock>
</TabItem>
<TabItem value="up_to_6.2" label="up_to_6.2">
<CodeBlock language="csharp">
{`// The create overload using a predicate:
// ======================================
string Create<T>(Expression<Func<T, bool>> predicate = null,
    SubscriptionCreationOptions options = null,
    string database = null);

Task<string> CreateAsync<T>(Expression<Func<T, bool>> predicate = null,
    SubscriptionCreationOptions options = null,
    string database = null,
    CancellationToken token = default);

// The options class:
// ==================
public class SubscriptionCreationOptions
{
    public string Name { get; set; }
    public string Query { get; set; }
    public string ChangeVector { get; set; }
    public string MentorNode { get; set; }
    public virtual bool Disabled { get; set; }
    public virtual bool PinToMentorNode { get; set; }
    public ArchivedDataProcessingBehavior? ArchivedDataProcessingBehavior { get; set; }
}
`}
</CodeBlock>
</TabItem>
</Tabs>



## HTTP-Compression algorithm is now `Zstd` by default
From RavenDB `7.0` on, the default HTTP compression algorithm is `Zstd` (instead of `Gzip`, used in earlier versions).  

<Admonition type="note" title="To switch the HTTP-compression algorithm:" id="to-switch-the-http-compression-algorithm" href="#to-switch-the-http-compression-algorithm">

Clients can switch to a different HTTP-Compression algorithm using `DocumentStore`'s 
[DocumentConventions.HttpCompressionAlgorithm](../../client-api/configuration/conventions.mdx#httpcompressionalgorithm) convention.  

<TabItem value="SwitchCompressionAlgorithm" label="SwitchCompressionAlgorithm">
<CodeBlock language="csharp">
{`var DocumentConventions = new DocumentConventions
\{
    // Switch HTTP compression algorithm
    HttpCompressionAlgorithm = HttpCompressionAlgorithm.Gzip
\};
`}
</CodeBlock>
</TabItem>

</Admonition>

<Admonition type="warning" title="Warning">
If you migrate from an earlier RavenDB version to version `7.0` or higher,  
please note the [potential significance of this change](../../migration/client-api/client-migration.mdx#client-migration-to-ravendb-7.x).  
</Admonition>



## Bulk-insert Compression is now Enabled by default

Compression is now [Enabled by default for bulk-insert operations](../../client-api/bulk-insert/how-to-work-with-bulk-insert-operation.mdx#section).  

<TabItem value="csharp" label="csharp">
<CodeBlock language="csharp">
{`CompressionLevel DefaultCompressionLevel = CompressionLevel.Fastest;
`}
</CodeBlock>
</TabItem>

<Admonition type="note" title="To switch the bulk-insert state:" id="to-switch-the-bulk-insert-state" href="#to-switch-the-bulk-insert-state">

Clients can switch to a different bulk-insert compression state using `Store`'s
[BulkInsertOptions.CompressionLevel](../../client-api/bulk-insert/how-to-work-with-bulk-insert-operation.mdx#bulkinsertoptions) option.  

<TabItem value="switchBulkInsertState" label="switchBulkInsertState">
<CodeBlock language="csharp">
{`using (var bulk = store.BulkInsert(new BulkInsertOptions
\{
    // Disable bulk-insert compression
    CompressionLevel = CompressionLevel.NoCompression
\}));
`}
</CodeBlock>
</TabItem>

</Admonition>



## Removed irrelevant `SingleNodeBatchCommand` parameters

We removed from [SingleNodeBatchCommand](../../client-api/commands/batches/how-to-send-multiple-commands-using-a-batch.mdx)'s
definition the parameters that are mainly used internally and kept only those relevant to the user.

<Admonition type="note" title="`SingleNodeBatchCommand` signature:" id="singlenodebatchcommand-signature" href="#singlenodebatchcommand-signature">
<Tabs groupId='languageSyntax'>
<TabItem value="7.0_and_on" label="7.0_and_on">
<CodeBlock language="plain">
{`public SingleNodeBatchCommand
    (DocumentConventions conventions, 
     IList<ICommandData> commands, 
     BatchOptions options = null)
`}
</CodeBlock>
</TabItem>
<TabItem value="up_to_6.2" label="up_to_6.2">
<CodeBlock language="plain">
{`public SingleNodeBatchCommand
    (DocumentConventions conventions, 
     JsonOperationContext context, 
     IList<ICommandData> commands, 
     BatchOptions options = null, 
     TransactionMode mode = TransactionMode.SingleNode)
`}
</CodeBlock>
</TabItem>
</Tabs>
</Admonition>



## Removed obsolete methods

The following methods are no longer used and have been removed from RavenDB `7.0`.  

* `NextPageStart`  
<TabItem value="csharp" label="csharp">
<CodeBlock language="csharp">
{`public int NextPageStart \{ get; set; \}
`}
</CodeBlock>
</TabItem>

* `GenerateEntityIdOnTheClient`  
<TabItem value="csharp" label="csharp">
<CodeBlock language="csharp">
{`public GenerateEntityIdOnTheClient(DocumentConventions conventions,
                                   Func<object, string> generateId)
`}
</CodeBlock>
</TabItem>

* `InMemoryDocumentSessionOperations.GenerateId`  
<TabItem value="csharp" label="csharp">
<CodeBlock language="csharp">
{`protected override string GenerateId(object entity)
`}
</CodeBlock>
</TabItem>

* `InMemoryDocumentSessionOperations.GetOrGenerateDocumentIdAsync`  
<TabItem value="csharp" label="csharp">
<CodeBlock language="csharp">
{`protected async Task<string> GetOrGenerateDocumentIdAsync(object entity)
`}
</CodeBlock>
</TabItem>



## `FromEtl` is now internal
The `CounterBatch` class `FromEtl` property is now **internal**.  
`FromEtl` is used internally to get or set a value indicating whether a counters batch originated from an ETL process.


